summarise(across(zn:medv,list(mean=mean,variance=sqrt(sd))))
#grab a column of the df
df%>%
group_by(factor(target))%>%
summarise(across(zn:medv,list(mean=mean,sd=sd)))
#grab a column of the df
df%>%
group_by(factor(target))%>%
summarise(across(zn:medv,list(mean=mean,sd=sqrt(sd))))
summarise(across(zn:medv,list(mean=mean,sd=sqrt(sd)))
#grab a column of the df
df%>%
#grab a column of the df
df%>%
group_by(factor(target))%>%
summarise(across(zn:medv,list(mean=mean,variance=sd^2)))
#grab a column of the df
df%>%
group_by(factor(target))%>%
summarise(across(zn:medv,list(mean=mean,sd=sd)))
#grab a column of the df
df%>%
group_by(factor(target))%>%
summarise(across(zn:medv,list(mean=mean,sd=sd^2)))
#grab a column of the df
df%>%
group_by(factor(target))%>%
summarise(across(zn:medv,list(mean=mean,sd=as.numeric(sd)^2)))
#grab a column of the df
df%>%
group_by(factor(target))%>%
summarise(across(zn:medv,list(mean=mean,sd=sd)))
#grab a column of the df
df%>%
group_by(factor(target))%>%
summarise(across(zn:medv,list(mean=mean,variance=sd)))
#grab a column of the df
df%>%
group_by(factor(target))%>%
summarise(across(zn:medv,list(mean=mean,variance=var)))
#grab a column of the df
df%>%
group_by(factor(target))%>%
summarise(across(zn:medv,variance=var))
#grab a column of the df
df%>%
group_by(factor(target))%>%
summarise(across(zn:medv,list(variance=var)))
#grab a column of the df
variance_df<-df%>%
group_by(factor(target))%>%
summarise(across(zn:medv,list(variance=var)))
View(variance_df)
pivot_longer(df,names_to = variables,)
pivot_longer(df,cols = factor(target),names_to = variables,)
pivot_longer(df,cols = "factor(target)",names_to = variables,)
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(variance=var)))
pivot_longer(!target,names_to=vars, values_to='variance')
variance_df%>%pivot_longer(!target,names_to=vars, values_to='variance')
transpose(variance_df)
transpose(variance_df)
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(variance=var)))
View(variance_df)
zero=variance_df[1,]
variables=colnames(variance_df)
zero=variance_df[1,][-1]
one=variance_df[2,][1]
variables=colnames(variance_df)[-1]
var_df<-data.frame(zero,one,colnames(variables))
var_df<-data.frame(zero,one)%>%`colnames<-variables
var_df<-data.frame(zero,one)%>%colnames<-variables
var_df<-data.frame(zero,one)%>%colnames<-variables
colnames(var_df)<-variables
var_df<-data.frame(zero,one)
colnames(var_df)<-variables
var_df<-data.frame(vars=variables,zero,one)
View(var_df)
var_df<-data.frame(varsvariables,zero,one)
var_df<-data.frame(variables,zero,one)
var_df<-data.frame(zero,one)
View(var_df)
var_df<-data.frame(0=zero,1=one)
View(zero)
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(variance=var)))
zero=unlist(variance_df[1,][-1])
one=unlist(variance_df[2,][1])
zero=unlist(variance_df[1,][-1])
one=unlist(variance_df[2,][-1])
variables=colnames(variance_df)[-1]
var_df<-data.frame('0'=zero,'1'=one)
View(var_df)
colnames(var_df)<-c(0,1)
View(var_df)
View(variance_df)
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(variance=var)))
zero=unlist(variance_df[1,][-1])
one=unlist(variance_df[2,][-1])
zero=unlist(variance_df[1,])
one=unlist(variance_df[2,])
variance_df[1,]
variance_df[2,]
zero=unlist(variance_df[1,])[-1]
one=unlist(variance_df[2,])[-1]
variables=colnames(variance_df)[-1]
var_df<-data.frame('0'=zero,'1'=one)
View(var_df)
colnames(var_df)<-c(0,1)
var_df['difference_variance']<-abs(var_df$0-vardf$1)
var_df<-data.frame(zero=zero,one=one)
colnames(var_df)<-c(0,1)
var_df['difference_variance']<-abs(var_df$zero-vardf$one)
var_df['difference_variance']<-abs(var_df$zero-var_df$one)
View(var_df)
var_df['difference_variance']<-var_df$zero-var_df$one
View(var_df)
var_df%>%mutate(dif=abs(zero-one))
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(variance=var)))
zero=unlist(variance_df[1,])[-1]
one=unlist(variance_df[2,])[-1]
variables=colnames(variance_df)[-1]
var_df<-data.frame(zero=zero,one=one)
colnames(var_df)<-c(0,1)
var_df%>%mutate(dif=abs(zero-one))
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(variance=var)))
zero=unlist(variance_df[1,])[-1]
one=unlist(variance_df[2,])[-1]
variables=colnames(variance_df)[-1]
var_df<-data.frame(variables=variables,zero=zero,one=one)
colnames(var_df)<-c(variables,)
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(variance=var)))
zero=unlist(variance_df[1,])[-1]
one=unlist(variance_df[2,])[-1]
variables=colnames(variance_df)[-1]
var_df<-data.frame(variables=variables,zero=zero,one=one)
var_df%>%mutate(dif=abs(zero-one))
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(variance=var)))
zero=unname(unlist(variance_df[1,])[-1])
one=unname(unlist(variance_df[2,])[-1])
variables=colnames(variance_df)[-1]
var_df<-data.frame(variables=variables,zero=zero,one=one)
var_df%>%mutate(dif=abs(zero-one))
var_df%>%mutate(abs_dif=abs(zero-one)/mean(zero+one))
ggplot(var_df,aes(x=variables,y=abs_df))+geom_bar()
ggplot(var_df,aes(x=variables,y=abs_dif))+geom_bar()
var_df<-var_df%>%mutate(abs_dif=abs(zero-one)/mean(zero+one))
ggplot(var_df,aes(x=variables,y=abs_dif))+geom_bar()
ggplot(var_df,aes(x=variables,y=abs_dif))+geom_point()
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(v=var)))
zero=unname(unlist(variance_df[1,])[-1])
one=unname(unlist(variance_df[2,])[-1])
variables=colnames(variance_df)[-1]
var_df<-data.frame(variables=variables,zero=zero,one=one)
var_df<-var_df%>%mutate(abs_dif=abs(zero-one)/mean(zero+one))
ggplot(var_df,aes(x=variables,y=abs_dif))+geom_point()
View(variance_df)
var_df<-var_df%>%mutate(abs_dif=abs(zero-one)/mean(zero))
ggplot(var_df,aes(x=variables,y=abs_dif))+geom_point()
ggplot(var_df%>%filter(v!=tax_v),aes(x=variables,y=abs_dif))+geom_point()
View(variance_df)
View(var_df)
ggplot(var_df%>%filter(variables!=tax_v),aes(x=variables,y=abs_dif))+geom_point()
ggplot(var_df%>%filter(variables!=tax_v),aes(x=variables,y=abs_dif))+geom_point()
ggplot(var_df%>%filter(variables==tax_v),aes(x=variables,y=abs_dif))+geom_point()
View(var_df)
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(v=var)))
zero=unname(unlist(variance_df[1,])[-1])
one=unname(unlist(variance_df[2,])[-1])
variables=colnames(variance_df)[-1]
var_df<-data.frame(variables=v,zero=zero,one=one)
View(variance_df)
View(variance_df)
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(v=var)))
zero=unname(unlist(variance_df[1,])[-1])
one=unname(unlist(variance_df[2,])[-1])
variables=colnames(variance_df)[-1]
var_df<-data.frame(v=variables,zero=zero,one=one)
var_df<-var_df%>%mutate(abs_dif=abs(zero-one)/mean(zero))
ggplot(var_df%>%filter(variables=tax_v),aes(x=variables,y=abs_dif))+geom_point()
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(v=var)))
zero=unname(unlist(variance_df[1,])[-1])
one=unname(unlist(variance_df[2,])[-1])
variables=colnames(variance_df)[-1]
var_df<-data.frame(v=variables,zero=zero,one=one)
var_df<-var_df%>%mutate(abs_dif=abs(zero-one)/mean(zero))
ggplot(var_df%>%filter(v=tax_v),aes(x=variables,y=abs_dif))+geom_point()
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(v=var)))
zero=unname(unlist(variance_df[1,])[-1])
one=unname(unlist(variance_df[2,])[-1])
variables=colnames(variance_df)[-1]
var_df<-data.frame(v=variables,zero=zero,one=one)
var_df<-var_df%>%mutate(abs_dif=abs(zero-one)/mean(zero))
ggplot(var_df%>%filter(v!=tax_v),aes(x=variables,y=abs_dif))+geom_point()
var_df%>%filter(v!=tax_v)
View(var_df)
ggplot(var_df%>%filter(v!='tax_v'),aes(x=variables,y=abs_dif))+geom_point()
var_df%>%filter(v!='tax_v')
install.packages('kableExtra')
var_df%>%kbl()%>%kable_classic()
var_df%>%kbl()
kbl(var_df)
library(kableExtra)
var_df%>%kbl()
var_df%>%kbl()%>%kable_classic_2()
round(var_df,2)%>%kbl()%>%kable_classic_2()
round(var_df)%>%kbl()%>%kable_classic_2()
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(v=var)))
zero=round(unname(unlist(variance_df[1,])[-1]),2)
one=round(unname(unlist(variance_df[2,])[-1]),2)
variables=colnames(variance_df)[-1]
var_df<-data.frame(v=variables,zero=zero,one=one)
library(kableExtra)
round(var_df)%>%kbl()%>%kable_classic_2()
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(v=var)))
zero=round(unname(unlist(variance_df[1,])[-1]),2)
one=round(unname(unlist(variance_df[2,])[-1]),2)
variables=colnames(variance_df)[-1]
var_df<-data.frame(v=variables,zero=zero,one=one)
library(kableExtra)
var_df%>%kbl()%>%kable_classic_2()
var_list<c('zn','nox','age','dis','rad','tax','ptratio','medv')
var_list<-c('zn','nox','age','dis','rad','tax','ptratio','medv')
var_dv_view<-var_df%>%select(var_list)
var_dv_view<-var_df%>%select(c('zn','nox','age','dis','rad','tax','ptratio','medv'))
var_dv_view<-var_df%>%filter(v=-var_list)
var_dv_view<-var_df%>%filter(v=var_list)
var_dv_view<-var_df%>%filter(v==var_list)
var_dv_view<-var_df%>%filter(v=or(var_list))
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(v=var)))
zero=round(unname(unlist(variance_df[1,])[-1]),2)
one=round(unname(unlist(variance_df[2,])[-1]),2)
variables=colnames(variance_df)[-1]
var_df<-data.frame(v=variables,zero=zero,one=one)
library(kableExtra)
var_list<-c('zn','nox','age','dis','rad','tax','ptratio','medv')
var_dv_view<-var_df%>%filter(v=='zn'|'nox'|'age'|'dis'|'rad'|'tax'|'ptratio'|'medv')
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(v=var)))
zero=round(unname(unlist(variance_df[1,])[-1]),2)
one=round(unname(unlist(variance_df[2,])[-1]),2)
variables=colnames(variance_df)[-1]
var_df<-data.frame(v=variables,zero=zero,one=one)
library(kableExtra)
var_list<-c('zn','nox','age','dis','rad','tax','ptratio','medv')
var_dv_view<-var_df%>%filter(v='zn'|'nox'|'age'|'dis'|'rad'|'tax'|'ptratio'|'medv')
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(v=var)))
zero=round(unname(unlist(variance_df[1,])[-1]),2)
one=round(unname(unlist(variance_df[2,])[-1]),2)
variables=colnames(variance_df)[-1]
var_df<-data.frame(v=variables,zero=zero,one=one)
library(kableExtra)
var_list<-c('zn','nox','age','dis','rad','tax','ptratio','medv')
var_df%>%kbl()%>%kable_classic_2()
glm_list[['transform_log']]<-glm(target~zn+indus+chas+nox+rm+age+dis+rad+tax+ptratio+lstat+medv+log(zn)+log(nox)+log(tax+log(age)+log(medv)),family=binomial(),data=df)
glm_list[['transform_log']]<-glm(target~zn+indus+chas+nox+rm+age+dis+rad+tax+ptratio+lstat+medv+log(zn+.1)+log(nox+.1)+log(tax+log(age+.1)+log(medv+.1)),family=binomial(),data=df)
summary(glm_list[['transform_log']])
glm_list[['transform_log']]<-glm(target~zn+indus+chas+nox+rm+age+dis+rad+tax+ptratio+lstat+medv+log(zn+.1)+log(nox+.1)+log(tax)+log(age+.1)+log(medv+.1)),family=binomial(),data=df)
glm_list[['transform_log']]<-glm(target~zn+indus+chas+nox+rm+age+dis+rad+tax+ptratio+lstat+medv+log(zn+.1)+log(nox+.1)+log(tax+.1)+log(age+.1)+log(medv+.1),family=binomial(),data=df)
summary(glm_list[['transform_log']])
mmps(glm_list[['transform_log']])
ggplot(df%>%group_by(target),aes(x=ptratio,y=rm,color=target))+geom_point()+geom_smooth(method='lm',se=FALSE)
ggplot(df%>%group_by(factor(target)),aes(x=ptratio,y=rm,color=target))+geom_point()+geom_smooth(method='lm',se=FALSE)
ggplot(df%>%group_by(factor(target)),aes(x=ptratio,y=rm,color=factor(target)))+geom_point()+geom_smooth(method='lm',se=FALSE)
glm_list[['trans_select']]<-step(glm_list[['transform_log']])
halfnorm(residuals(glm_list[['trans_select']]))
resid_panel(glm_list[['trans_back']])
library(ggResidpanel)
resid_panel(glm_list[['trans_back']])
resid_panel(glm_list[['trans_select']])
summary(glm_list[['trans_select']])
pchisq(645.88-145,465-452,lower.tail=FALSE)
lapply(
X=glm_list,
FUN = AIC
)
pchisq(193-145,1,lower.tail=FALSE)
lapply(glm_list, summary)
a<-summary(glm_list[['general']])
View(a)
a
lapply(glm_list, summary$df.residual)
a$df.residual
lapply(glm_list, function(x)summary(x))
lapply(glm_list, function(x)summary(x)$df.residual)
return(a)
lapply(glm_list, function(x){
a<-summary(x)$df.residual
return(a)
})
lapply(glm_list, function(x){
dev<-summary(x)$deviance
df_res<-summary(x)$df.residual
ls<-list(dev,df_res)
return(ls)
})
lapply(glm_list, function(x){
dev<-summary(x)$deviance
df_res<-summary(x)$df.residual
ls<-list(deviance=dev,degrees_freedom=df_res)
return(ls)
})
a<-lapply(glm_list, function(x){
dev<-summary(x)$deviance
df_res<-summary(x)$df.residual
ls<-list(deviance=dev,degrees_freedom=df_res)
return(ls)
})
View(a)
dt_list<-map(a,as.data.table)
as.data.frame(do.call(rbind,a))
pchisq(145.552-144.2748,452-448,lower.tail = FALSE)
ggplot(df,aes(x=nox,y=dis,color=factor(target)))+geom_point()+geom_smooth(method='lm',se=FALSE)
ggplot(df,aes(x=medv,y=rm,color=factor(target)))+geom_point()+geom_smooth(method='lm',se=FALSE)
df_raw<-read.csv(here('crime-training-data_modified.csv'))
#train data
n = df_raw
install.packages('rsample')
#train data
library(rsample)
set.seed(123)
data_split<-initial_split(df_raw,prop=.70)
df<-training(data_split)
df_test<-testing(data_split)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(GGally)
library(MASS)
library(car)
library(here)
df_raw<-read.csv(here('crime-training-data_modified.csv'))
#train data
library(rsample)
set.seed(123)
data_split<-initial_split(df_raw,prop=.70)
df<-training(data_split)
df_test<-testing(data_split)
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(v=var)))
zero=unname(unlist(variance_df[1,])[-1])
one=unname(unlist(variance_df[2,])[-1])
variables=colnames(variance_df)[-1]
var_df<-data.frame(v=variables,zero=zero,one=one)
var_df<-var_df%>%mutate(abs_dif=abs(zero-one)/mean(zero))
glm.general<-glm(target~.,family=binomial(),data=df)
summary(glm.general)
#model building
glm_list<-list()
glm_list[['general']]<-glm(
target~.,
family=binomial(),
data=df
)
#backward selection
glm_list[['back']]<-step(glm_list[['general']])
summary(glm_list[['back']])
mmps(glm_list[['back']])
#grab a column of the df
variance_df<-df%>%
group_by(target)%>%
summarise(across(zn:medv,list(v=var)))
zero=round(unname(unlist(variance_df[1,])[-1]),2)
one=round(unname(unlist(variance_df[2,])[-1]),2)
variables=colnames(variance_df)[-1]
var_df<-data.frame(v=variables,zero=zero,one=one)
library(kableExtra)
var_list<-c('zn','nox','age','dis','rad','tax','ptratio','medv')
var_df%>%kbl()%>%kable_classic_2()
glm_list[['transform_log']]<-glm(target~zn+indus+chas+nox+rm+age+dis+rad+tax+ptratio+lstat+medv+log(zn+.1)+log(nox+.1)+log(tax+.1)+log(age+.1)+log(medv+.1),family=binomial(),data=df)
summary(glm_list[['transform_log']])
mmps(glm_list[['transform_log']])
ggplot(df%>%group_by(factor(target)),aes(x=ptratio,y=rm,color=factor(target)))+geom_point()+geom_smooth(method='lm',se=FALSE)
glm_list[['trans_select']]<-step(glm_list[['transform_log']])
halfnorm(residuals(glm_list[['trans_select']]))
summary(glm_list[['trans_select']])
lapply(
X=glm_list,
FUN = AIC
)
pchisq(193-145,1,lower.tail=FALSE)
a<-lapply(glm_list, function(x){
dev<-summary(x)$deviance
df_res<-summary(x)$df.residual
ls<-list(deviance=dev,degrees_freedom=df_res)
return(ls)
})
df_predict<-df_test%>%select(-target)
View(df_test)
df_predict<-df_test%>%dplyr::select(-target)
View(df_predict)
?predict
predict(glm_list[['trans_select']])
predict(glm_list[['trans_select']],df_predict)
predict(glm_list[['trans_select']],df_predict, type='response')
log(predict(glm_list[['trans_select']],df_predict, type='response'))
e^(predict(glm_list[['trans_select']],df_predict, type='response'))
exp^(predict(glm_list[['trans_select']],df_predict, type='response'))
exp^(predict(glm_list[['trans_select']],df_predict, type='response')))
predict(glm_list[['trans_select']],df_predict, type='response'))
predict(glm_list[['trans_select']],df_predict, type='response')
predict(glm_list[['trans_select']],newdata=df_predict, type='response')
predictions<-predict(glm_list[['trans_select']],newdata=df, type='response')
res_df<-data.frame(true_value=df$target,prediction=predictions)
res_df
res_df%>%mutate(pred_logic=case_when(prediction>.5 ~1, TRUE~0))
library(caret)
confusionMatrix(df_res$pred_logic,df_res$true_value)
confusionMatrix(res_df$pred_logic,res_df$true_value)
confusionMatrix(as.factor(res_df$pred_logic),as.factor(res_df$true_value))
confusionMatrix(as.numeric(res_df$pred_logic),as.numeric(res_df$true_value))
dres_df<-res_df%>%mutate(pred_logic=case_when(prediction>.5 ~1, TRUE~0))
library(caret)
confusionMatrix(as.numeric(res_df$pred_logic),as.numeric(res_df$true_value))
res_df<-res_df%>%mutate(pred_logic=case_when(prediction>.5 ~1, TRUE~0))
library(caret)
confusionMatrix(as.numeric(res_df$pred_logic),as.numeric(res_df$true_value))
confusionMatrix(res_df$pred_logic,res_df$true_value)
res_df
df_predict<-df_test%>%dplyr::select(-target)
predictions<-predict(glm_list[['trans_select']],newdata=df, type='response')
res_df<-data.frame(true_value=df$target,prediction=predictions)
res_df<-res_df%>%mutate(pred_logic=case_when(prediction>.5 ~1, TRUE~0))
res_df<-res_df%>%mutate(pred_logic=case_when(prediction>.5 ~1, TRUE~0))%>%select(-predictions)
res_df<-res_df%>%mutate(pred_logic=case_when(prediction>.5 ~1, TRUE~0))%>%select(-prediction)
res_df<-res_df%>%mutate(pred_logic=case_when(prediction>.5 ~1, TRUE~0))%>%dplyr::select(-predictions)
df_predict<-df_test%>%dplyr::select(-target)
predictions<-predict(glm_list[['trans_select']],newdata=df, type='response')
res_df<-data.frame(true_value=df$target,prediction=predictions)
res_df<-res_df%>%mutate(pred_logic=case_when(prediction>.5 ~1, TRUE~0))%>%dplyr::select(-predictions)
df_predict<-df_test%>%dplyr::select(-target)
predictions<-predict(glm_list[['trans_select']],newdata=df, type='response')
res_df<-data.frame(true_value=df$target,prediction=predictions)
res_df<-res_df%>%mutate(pred_logic=case_when(prediction>.5 ~1, TRUE~0))
res_df<-res_df%>%mutate(pred_logic=case_when(prediction>.5 ~1, TRUE~0))%>%dplyr::select(-predictions)
df_predict<-df_test%>%dplyr::select(-target)
predictions<-predict(glm_list[['trans_select']],newdata=df, type='response')
res_df<-data.frame(true_value=df$target,prediction=predictions)
View(res_df)
res_df<-res_df%>%mutate(pred_logic=case_when(prediction>.5 ~1, TRUE~0))%>%dplyr::select(-prediction)
df_predict<-df_test%>%dplyr::select(-target)
predictions<-predict(glm_list[['trans_select']],newdata=df, type='response')
res_df<-data.frame(t=df$target,prediction=predictions)
res_df<-res_df%>%mutate(p=case_when(prediction>.5 ~1, TRUE~0))%>%dplyr::select(-prediction)
library(caret)
confusionMatrix(res_df$pred_logic,res_df$true_value)
View(res_df)
summary(res_df)
confusionMatrix(res_df$p,res_df$t)
confusionMatrix(as.numeric(res_df$p),as.numeric(res_df$t))
res_df<-res_df%>%mutate(p=as.factor(case_when(prediction>.5 ~1, TRUE~0)))%>%dplyr::select(-prediction)
df_predict<-df_test%>%dplyr::select(-target)
predictions<-predict(glm_list[['trans_select']],newdata=df, type='response')
res_df<-data.frame(t=df$target,prediction=predictions)
res_df<-res_df%>%mutate(p=as.factor(case_when(prediction>.5 ~1, TRUE~0)))%>%dplyr::select(-prediction)
confusionMatrix(as.factor(res_df$p),as.factor(res_df$t))
predictions<-predict(glm_list[['trans_select']],newdata=df_predict, type='response')
confusionMatrix(as.factor(predictions),as.factor(df_test$target))
p=as.factor(case_when(predictions>.5 ~1, TRUE~0))
confusionMatrix(as.factor(p),as.factor(df_test$target))
