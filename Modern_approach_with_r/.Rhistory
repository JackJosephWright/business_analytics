cost_res<-dat%>%filter(TYPE=='RESIDENTIAL' & BILL<bill_60_commercial)%>%summarize(sum(BILL))
income_res<-dat%>%filter(TYPE=='RESIDENTIAL' & BILL>bill_60_commercial)%>%summarize(sum(BILL))
(profit=income_com-cost_com)
#profits from residential debts
cost_res<-dat%>%filter(TYPE=='RESIDENTIAL' & BILL<bill_60_commercial)%>%summarize(sum(BILL))
income_res<-dat%>%filter(TYPE=='RESIDENTIAL' & BILL>bill_60_commercial)%>%summarize(sum(BILL))
(profit=income_res-cost_res)
#profits from residential debts
cost_res<-dat%>%filter(TYPE=='RESIDENTIAL' & BILL<bill_60)%>%summarize(sum(BILL))
income_res<-dat%>%filter(TYPE=='RESIDENTIAL' & BILL>bill_60)%>%summarize(sum(BILL))
(profit=income_res-cost_res)
(bill_60<-solve(.166,58))
#profit from commmercial debts
cost_com<-dat%>%filter(TYPE=='COMMERCIAL' & BILL<bill_60_commercial)%>%summarize(sum(BILL))
income_com<-dat%>%filter(TYPE=='COMMERCIAL' & BILL>bill_60_commercial)%>%summarize(sum(BILL))
(profit=income_com-cost_com)
#profits from residential debts
cost_res<-dat%>%filter(TYPE=='RESIDENTIAL' & BILL>bill_60)%>%summarize(sum(BILL))
income_res<-dat%>%filter(TYPE=='RESIDENTIAL' & BILL<bill_60)%>%summarize(sum(BILL))
(profit=income_res-cost_res)
#profit from commmercial debts
cost_com<-dat%>%filter(TYPE=='COMMERCIAL' & BILL<bill_60_commercial)%>%summarize(sum(BILL))
income_com<-dat%>%filter(TYPE=='COMMERCIAL' & BILL>bill_60_commercial)%>%summarize(sum(BILL))
(profit_com=income_com-cost_com)
#profits from residential debts
cost_res<-dat%>%filter(TYPE=='RESIDENTIAL' & BILL>bill_60)%>%summarize(sum(BILL))
income_res<-dat%>%filter(TYPE=='RESIDENTIAL' & BILL<bill_60)%>%summarize(sum(BILL))
(profit_res=income_res-cost_res)
(profit_res+profit_com)
com_profit_pre_promo<-dat%>%filter(TYPE=='COMMERCIAL' )%>%summarize(sum(BILL))
res_profit_pre_promo<-profit_res
com_profit_pre_promo<-dat%>%filter(TYPE=='COMMERCIAL' )%>%summarize(sum(BILL))
res_profit_pre_promo<-profit_res
(profit_res+profit_com)
(profit_res+profit_com/(com_profit_pre_promo+res_profit_pre_promo))
com_profit_pre_promo<-dat%>%filter(TYPE=='COMMERCIAL' )%>%summarize(sum(BILL))
res_profit_pre_promo<-profit_res
(profit_res+profit_com/(com_profit_pre_promo+res_profit_pre_promo))
com_profit_pre_promo
profit_com
profit_promo<-profit_res+profit_com
profit_promo
profit_null<-com_profit_pre_promo+res_profit_pre_promo
profit_null
com_profit_pre_promo
profit_promo/profit_null
C=profit_null*1/percentage_income
com_profit_pre_promo<-dat%>%filter(TYPE=='COMMERCIAL' )%>%summarize(sum(BILL))
res_profit_pre_promo<-profit_res
profit_promo<-profit_res+profit_com
profit_null<-com_profit_pre_promo+res_profit_pre_promo
percentage_income<-profit_promo/profit_null
(C=profit_null*1/percentage_income)
(C/profit_null))
(C/profit_null)
knitr::opts_chunk$set(echo = TRUE)
file<-here('data','overdue.txt')
file<-here('data','overdue.txt')
library(here)
library(tidyverse)
file<-here('data','overdue.txt')
dat<-read.table(file, header=TRUE)
#create residential vs commercial factor
dat_res<-dat[1:48,]%>%mutate(TYPE='RESIDENTIAL')
dat_com<-dat[-(1:48),]%>%mutate(TYPE='COMMERCIAL')
dat<-rbind(dat_res, dat_com)
library(GGally)
ggpairs(dat, mapping=(aes(color=TYPE)))
summary(lm.full<-lm(LATE~BILL+TYPE, data=dat))
summary(lm.full<-lm(LATE~BILL, data=dat))
summary(lm.split<-lm(LATE~BILL+TYPE+TYPE:BILL:., data=dat))
anova(lm.full,lm.split)
(bill_60<-solve(.166,58))
(bill_60_commercial<-solve(-.19, (60-101.7)))
#profit from commmercial debts
cost_com<-dat%>%filter(TYPE=='COMMERCIAL' & BILL<bill_60_commercial)%>%summarize(sum(BILL))
income_com<-dat%>%filter(TYPE=='COMMERCIAL' & BILL>bill_60_commercial)%>%summarize(sum(BILL))
(profit_com=income_com-cost_com)
#profits from residential debts
cost_res<-dat%>%filter(TYPE=='RESIDENTIAL' & BILL>bill_60)%>%summarize(sum(BILL))
income_res<-dat%>%filter(TYPE=='RESIDENTIAL' & BILL<bill_60)%>%summarize(sum(BILL))
(profit_res=income_res-cost_res)
com_profit_pre_promo<-dat%>%filter(TYPE=='COMMERCIAL' )%>%summarize(sum(BILL))
res_profit_pre_promo<-profit_res
profit_promo<-profit_res+profit_com
profit_null<-com_profit_pre_promo+res_profit_pre_promo
percentage_income<-profit_promo/profit_null
com_profit_pre_promo<-dat%>%filter(TYPE=='COMMERCIAL' )%>%summarize(sum(BILL))
res_profit_pre_promo<-profit_res
profit_promo<-profit_res+profit_com
profit_null<-com_profit_pre_promo+res_profit_pre_promo
(percentage_income<-profit_promo/profit_null)
(C=profit_null*1/percentage_income)
(C/profit_null)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
file<-here('data','nyc.csv')
dat<-read.csv(file)
View(dat)
ggpairs(dat)
library(GGally)
ggpairs(dat)
ggpairs(dat%>%select(-Restaurant))
ggpairs(dat%>%select(c(Food, Decor, Service)))
lm.model<-lm(PRICE~.,data=dat%>%select(-Restaurant))
View(dat)
lm.model<-lm(Price~.,data=dat%>%select(-c(Restaurant,Case))
library(ggResidpanel)
library(ggResidpanel)
resid_panel(lm.model)
lm.model<-lm(Price~.,data=dat%>%select(-c(Restaurant,Case))
resid_panel(lm.model)
resid_panel(lm.model)
lm.model<-lm(Price~.,data=dat%>%select(-c(Restaurant,Case))
library(ggResidpanel)
lm.model<-lm(Price~.,data=dat%>%select(-c(Restaurant,Case)))
library(ggResidpanel)
resid_panel(lm.model)
resid_panel(lm.model, plots = 'all')
file<-here('data','nonlinear.txt')
dat<-read.table(file)
file<-here('data','nonlinearx.txt')
dat<-read.table(file)
View(dat)
dat<-read.table(file, header=TRUE)
View(dat)
ggpairs(dat)
lm.model<-lm(y~.,data=dat)
library(ggResidpanel)
resid_panel(lm.model, plots = 'all')
resid_xpanel(lm.model)
model<-lm(y~x1+x2+...,data=df)
model<-lm(y~x1+x2,data=dat)
avPlots(model)
library(car)
library(car)
model<-lm(y~x1+x2,data=dat)
avPlots(model)
model<-lm(mpg~disp+hp+drat, data=mtcars)
summary(model)
avPlots(model)
library(tidyverse)
library(here)
file<-here('data','nyc.csv')
dat<-read.csv(file)
ggpairs(dat)
ggpairs(dat%>%(-Restaurant))
ggpairs(dat%>%select(-Restaurant))
ggpairs(dat%>%select(-c(Restaurant,case)))
ggpairs(dat%>%select(-c(Restaurant,Case)))
model<-lm(Price~., data=dat%>%select(-c(Restaurant,Case)))
avPlot(model)
model<-lm(Price~., data=dat%>%select(-c(Restaurant,Case)))
avPlot(model)
avPlots(model)
file<-here('data','defects.txt')
dat<-read.table(file,header=TRUE)
View(dat)
ggpairs(dat)
ggpairs(dat%>%select(Defective,Temperature,Density, Rate))
model<-lm(Defective~Temperature, Density, Rate, data=dat%>%select(-Case))
summary(model<-lm(Defective~Temperature, Density, Rate, data=dat%>%select(-Case)))
summary(model<-lm(Defective~Temperature+Density+Rate, data=dat%>%select(-Case)))
resid_panel(model)
resid_xpanel(model)
resid_panel(model)
resid_panel(model, plots='all')
resid_xpanel(model)
model$fitted.values
df=data.frame(y_hat=model$fitted.values,Defective=dat$Defective)
ggplot(df, aes(x=Defective, y=y_hat))+geom_point()
summary(model_transform<-lm(sqrt(Defective)~Temperature+Density+Rate, data=dat)
summary(model_transform<-lm(sqrt(Defective)~Temperature+Density+Rate, data=dat))
View(dat)
summary(model_transform<-lm(sqrt(Defective)~Temperature+Density+Rate, data=dat))
boxCox(dat)
?boxcox
boxCox(dat$Defective)
summary(model<-lm(Defective~Temperature+Density+Rate, data=dat%>%select(-Case)))
boxCox(model)
bc<-boxcox(model)
bc<-boxCox(model)
(lambda<-bc$x[which.max(bc$y)])
file<-here('data','magazines.csv')
dat<-read_csv(file)
View(dat)
View(dat)
ggpairs(dat)
View(bc)
View(dat)
ggpairs(dat%>%select(c(AdRevenue,AdPages,SubRevenue)))
ggpairs(dat%>%select(c(AdRevenue,AdPages,SubRevenue.NewsRevenue)))
ggpairs(dat%>%select(c(AdRevenue,AdPages,SubRevenue,NewsRevenue)))
dat<-dat%>%select(c(AdRevenue,AdPages,SubRevenue,NewsRevenue)
box.cox.powers(dat)
dat<-dat%>%select(c(AdRevenue,AdPages,SubRevenue,NewsRevenue))
box.cox.powers(dat)
powerTransform(dat)
install.packages(alr3)
install.packages('alr3')
dat%>%mutate_at(c('AdPages','SubRevenue','NewsRevenue',log))
dat%>%mutate_at(c('AdPages','SubRevenue','NewsRevenue'),log)
dat<-dat%>%mutate_at(c('AdPages','SubRevenue','NewsRevenue'),log)
ggpairs(dat)
file<-here('data','magazines.csv')
dat<-read_csv(file)
dat_2<-dat%>%mutate_all(.,log)
dat_2<-mutate_all(dat,log)
library(car)
dat<-dat%>%select(c(AdRevenue,AdPages,SubRevenue,NewsRevenue))
powerTransform(dat)
dat_2<-mutate_all(dat,log)
ggpairs(dat_2)
dat<-read_table(here('data','circulation.txt'),header=TRUE)
dat<-read_table(here('data','circulation.txt'))
file<-here('data','circulation.txt')
dat<-read_table(file,header=TRUE)
dat<-read_table(file)
View(dat)
dat<-read_table(file, header=TRUE)
View(dat)
dat<-read_table(file)
file<-here('data','circulation.txt')
dat<-read_table(file)
View(dat)
file<-here('data','circulation2.txt')
dat<-read_table(file)
View(dat)
file<-here('data','circulation.txt')
dat<-read_table(file)
dat<-read_table(file, header=TRUE)
dat<-read_csv(file, header=TRUE)
file<-here('data','circulation.txt')
dat<-read_csv(file, sep='\t')
file<-here('data','circulation.txt')
dat<-read_csv(file)
View(dat)
dat<-read_csv(file, sep="\t")
file<-here('data','circulation.txt')
dat<-read_csv(file, sep="\t")
dat<-read_table(file, sep="\t")
?read_table
file<-here('data','circulation.txt')
dat<-read_table(file, sep="\t")
dat<-read_table(file)
View(dat)
dat<-read.table(file, sep="\t")
View(dat)
dat<-read.table(file, sep="\t", header=TRUE)
View(dat)
df<-dat%>%select(-Newspaper)
ggpairs(df)
View(df)
df<-df%>%mutate_at(c(Sunday,Weekday),log)
df<-df%>%mutate_at(c(Sunday,Weekday),log)
df<-df%>%mutate_at(c("Sunday","Weekday"),log)
ggpairs(df)
summary(lm.model<-lm(Sunday~.,data=df))
predict(lm.model, 210000)
?predict
predict(lm.model, newdata=data.frame(210000))
summary(lm.model<-lm(Sunday~.,data=df))
predict(lm.model, newdata=data.frame(210000))
predict(lm.model)
predict(lm.model, c(210000))
predict(lm.model, newdata=data.frame(x=210000))
predict(lm.model, newdata=data.frame(Weekday=210000))
predict(lm.model, newdata=data.frame(Weekday=210000), interval = 'predict')
predict(lm.model, newdata=data.frame(Weekday=210000,1), interval = 'predict')
rep(210000,2)''
rep(210000,2)
seq(1,2)
seq(0:1,2)
0:1
predict(lm.model, newdata=data.frame(Weekday=rep(210000,competitor=0:1),competitor), interval = 'predict')
View(df)
predict(lm.model, newdata=data.frame(Weekday=rep(210000,2),competitor=0:1), interval = 'predict')
summary(lm.model<-lm(Sunday~.,data=df))
predict(lm.model, newdata=data.frame(Weekday=rep(210000,2),competitor=0:1), interval = 'predict')
11.7*210000
(1+.117)*210000
(1+.1202)*210000
predict(lm.model, newdata=data.frame(Weekday=rep(210000,2),competitor=c(0,1)), interval = 'predict')
predict(lm.model, newdata=data.frame(Weekday=rep(210000,210000),competitor=c(0,1)), interval = 'predict')
predict(lm.model, newdata=data.frame(Weekday=c(210000,210000),competitor=c(0,1)), interval = 'predict')
predict(lm.model, newdata=data.frame(Weekday=c(log(210000),log(210000)),competitor=c(0,1)), interval = 'predict')
predictions<-predict(lm.model, newdata=data.frame(Weekday=c(log(210000),log(210000)),competitor=c(0,1)), interval = 'predict')
(predictions<-predict(lm.model, newdata=data.frame(Weekday=c(log(210000),log(210000)),competitor=c(0,1)), interval = 'predict'))
as.data.frame(predictions)
as.data.frame(predictions)%>%mutate_all(.,exp)
knitr::opts_chunk$set(echo = TRUE)
file<-here('data','bridge.txt')
getwd()
library(here)
file<-here('data','bridge.txt')
dat<-read.table(file,header=TRUE)
View(dat)
summary(lm.model<-lm(log(Time)~log(DArea)+log(CCost)+log(Dwgs)+log(Length)+log(Spans), data = dat))
ggpairs(dat)
library(GGally)
library(GGally)
ggpairs(dat)
ggpairs(log(dat))
ggpairs(dat)
install.packages('leaps')
library(leaps)
dat_2<-log(dat)
models<-regsubsets(Time~., data = dat_2, nvmax=5)
summary(models)
res.sum<-summary(models)
data.frame(
Adj.R2 = which.max(res.sum$adjr2),
CP = which.min(res.sum$cp),
BIC = which.min(res.sum$bc)
)
res.sum<-summary(models)
data.frame(
Adj.R2 = which.max(res.sum$adjr2),
CP = which.min(res.sum$cp),
BIC = which.min(res.sum$bic)
)
res.min$aic
library(tidyverse)
res.sum$adjr2
ggplot(res.sum$adjr2)+geom_point()
library(tidyverse)
ggplot(res.sum$adjr2)+geom_point()
df=data.frame(x=rep(length(res.sum$adjr2),y=res.sum$adjr2))
View(df)
df=data.frame(x=rep(length(res.sum$adjr2)),y=res.sum$adjr2))
rep(length(res.sum$adjr2)
rep(length(res.sum$adjr2))
rep(length(res.sum$adjr2))
seq(length(res.sum$adjr2))
df=data.frame(x=seq(length(res.sum$adjr2)),y=res.sum$adjr2))
df=data.frame(x=seq(length(res.sum$adjr2)),y=res.sum$adjr2)
View(df)
ggplot(df, aes(x=x,y=y))+geom_point()
ggplot(df, aes(x=x,y=y))+geom_point()+title('adjusted r^2 by number of predictors)
library(tidyverse)
df=data.frame(x=seq(length(res.sum$adjr2)),y=res.sum$adjr2)
ggplot(df, aes(x=x,y=y))+geom_point()+title('adjusted r^2 by number of predictors)
library(tidyverse)
df=data.frame(x=seq(length(res.sum$adjr2)),y=res.sum$adjr2)
ggplot(df, aes(x=x,y=y))+geom_point()+title('adjusted r^2 by number of predictors')
ggplot(df, aes(x=x,y=y))+geom_point()+ggtitle('adjusted r^2 by number of predictors')
df=data.frame(x=seq(length(res.sum$adjr2)),y=res.sum$bic)
ggplot(df, aes(x=x,y=y))+geom_point()+ggtitle('BIC by number of predictors')
file<-here('data','prostateTest.txt')
dat<-read.table(file,header=TRUE)
file<-here('data','prostateTest.txt')
dat<-read.table(file,header=TRUE)
file<-here('data','prostatetrain.txt')
file<-here('data','prostateTrain.txt')
train<-read.table(file,header=TRUE)
file<-here('data','prostateTrain.txt')
train<-read.table(file,header=TRUE)
file<-here('data','prostateTraining.txt')
train<-read.table(file,header=TRUE)
ggpairs(train)
ggpairs(train)
ggpairs(train%>%select(-original_case))
#look at predictors
ggpairs(train%>%select(-original_case))
library(ggResidpanel)
lm.model<-lm(lpsa~., data=train)
resid_panel(lm.model)
resid_panel(lm.model,plots = 'all')
?resid_panel
resid_panel(lm.model,plots = 'R')
resid_panel(lm.model,plots = 'yvp')
resid_panel(lm.model,plots = 'R')
summary(lm.model)
train<-train%>%select(-original_case)
#look at predictors
ggpairs(train%>%select(-original_case))
#look at predictors
ggpairs(train)
library(ggResidpanel)
lm.model<-lm(lpsa~., data=train)
resid_panel(lm.model,plots = 'R')
summary(lm.model)
resid_xpanel(lm.model)
resid_xpanel(lm.model,plot='yvp)
resid_xpanel(lm.model,plot='yvp')
resid_xpanel(lm.model,plot='yvp')
resid_xpanel(lm.model,plots='yvp')
resid_xpanel()
?resid_xpanel
resid_xpanel(lm.model)
library(car)
vif(lm.model)
library(leaps)
models<-regsubsets(lpsa~., data = train, nvmax=5)
summary(models)
res.sum<-summary(models)
data.frame(
Adj.R2 = which.max(res.sum$adjr2),
CP = which.min(res.sum$cp),
BIC = which.min(res.sum$bic)
)
models<-regsubsets(lpsa~., data = train, nvmax=7)
summary(models)
res.sum<-summary(models)
data.frame(
Adj.R2 = which.max(res.sum$adjr2),
CP = which.min(res.sum$cp),
BIC = which.min(res.sum$bic)
)
df=data.frame(x=seq(length(res.sum$adjr2)),y=res.sum$adjr2)
ggplot(df, aes(x=x,y=y))+geom_point()+ggtitle('adjusted r^2 by number of predictors')
summary(lm.final<-lm(lpsa~lcavol+lweight), data=train)
summary(lm.final<-lm(lpsa~lcavol+lweight), data=train))
summary(lm.final<-lm(lpsa~lcavol+lweight, data=train)
summary(lm.final<-lm(lpsa~lcavol+lweight, data=train))
summary(lm.test<-lm(lpsa ~lcavol+lweight,data=test))
file<-here('data','prostateTest.txt')
test<-read.table(file,header=TRUE)
file<-here('data','prostateTraining.txt')
train<-read.table(file,header=TRUE)
train<-train%>%select(-original_case)
summary(lm.test<-lm(lpsa ~lcavol+lweight,data=test))
install.packages('glmnet')
library(glmnet)
x=train%>%select(-lpsa)
y=train$lpsa
x=train%>%select(-lpsa)
#perform k fold cross-validation to find optimal lambda
cv_model<-cv.glmnet(x,y,alpha=1)
x=as.matrix(train%>%select(-lpsa))
#perform k fold cross-validation to find optimal lambda
cv_model<-cv.glmnet(x,y,alpha=1)
#find optimal lambda that minimizes mean squared error
best_lambda<-cv_model$lambda.min
#find optimal lambda that minimizes mean squared error
(best_lambda<-cv_model$lambda.min)
plot(cv_model)
library(glmnet)
#define response and predictor variables
y=train$lpsa
x=as.matrix(train%>%select(-lpsa))
#perform k fold cross-validation to find optimal lambda
cv_model<-cv.glmnet(x,y,alpha=1)
#find optimal lambda that minimizes mean squared error
(best_lambda<-cv_model$lambda.min)
plot(cv_model)
best_model<-glmnet(x,y,alpha=1,lambda = best_lambda)
coef(best_model)
file<-here('data','Mantel.txt')
df<-read.table(file,header=TRUE)
ggpairs(df)
models<-regsubsets(y., data = df, nvmax=3)
models<-regsubsets(y~., data = df, nvmax=3)
summary(models)
models<-regsubsets(y, data = df, nvmax=3)
summary(models)
models<-regsubsets(y~., data = df, nvmax=3)
models<-regsubsets(Y~., data = df, nvmax=3)
summary(models)
res.sum<-summary(models)
data.frame(
Adj.R2 = which.max(res.sum$adjr2),
CP = which.min(res.sum$cp),
BIC = which.min(res.sum$bic)
)
df=data.frame(x=seq(length(res.sum$adjr2)),y=res.sum$adjr2)
ggplot(df, aes(x=x,y=y))+geom_point()+ggtitle('adjusted r^2 by number of predictors')
df=data.frame(x=seq(length(res.sum$adjr2)),y=res.sum$bic)
ggplot(df, aes(x=x,y=y))+geom_point()+ggtitle('BIC by number of predictors')
df=data.frame(x=seq(length(res.sum$adjr2)),y=res.sum$cp)
df=data.frame(x=seq(length(res.sum$adjr2)),y=res.sum$cp)
ggplot(df, aes(x=x,y=y))+geom_point()+ggtitle('Cp by number of predictors')
summary(lm.forward<-lm(Y~X3,data=df))
df<-read.table(file,header=TRUE)
file<-here('data','Mantel.txt')
df<-read.table(file,header=TRUE)
summary(lm.forward<-lm(Y~X3,data=df))
summary(lm.forward<-lm(Y~X3+X2,data=df))
file<-here('data','Haldecement.txt')
file<-here('data','Haldecement.txt')
dat<-read.table(file,header=TRUE)
file<-here('data','Haldcement.txt')
dat<-read.table(file,header=TRUE)
ggpairs(dat)
models<-regsubsets(Y~., data = dat, nvmax=4)
summary(models)
res.sum<-summary(models)
data.frame(
Adj.R2 = which.max(res.sum$adjr2),
CP = which.min(res.sum$cp),
BIC = which.min(res.sum$bic)
)
df=data.frame(x=seq(length(res.sum$adjr2)),y=res.sum$adjr2)
ggplot(df, aes(x=x,y=y))+geom_point()+ggtitle('adjusted r^2 by number of predictors')
cor(dat)
library(corrplot)
cor(dat)
library(corrplot)
cor(dat)
corrplot(dat)
library(corrplot)
corrplot(dat)
file<-here('data','Haldcement.txt')
dat<-read.table(file,header=TRUE)
View(dat)
look at corrplot
#look at corrplot
library(corrplot)
corrplot(dat)
corrplot(cor(dat))
corrplot(cor(dat),method = 'number')
