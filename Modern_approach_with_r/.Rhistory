}
pp_sim<-function(){
for (i in 10000){
df_out<-data.frame(profit=double())
df<-profit_or_pay(n=110000)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
df_out<-rbind(df_out,profit-loss)
}}
pp_sim(0)
pp_sim()
return(df_out)
pp_sim<-function(TYPE='C'){
for (i in 10000){
df_out<-data.frame(profit=double())
df<-profit_or_pay(n=110000)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
df_out<-rbind(df_out,profit-loss)
return(df_out)
}}
pp_sim<-function(TYPE='C'){
df_out<-data.frame(profit=double())
for (i in 10000){
df<-profit_or_pay(n=110000)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
df_out<-rbind(df_out,profit-loss)
return(df_out)
}}
pp_sim<-function(TYPE='C'){
df_out<-data.frame(profit=double())
for (i in 10000){
df<-profit_or_pay(n=110000)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
df_out<-rbind(df_out,profit-loss)
}
return(df_out)
}
pp_sim<-function(TYPE='C'){
df_out<-data.frame(profit=double())
for (i in 10000){
df<-profit_or_pay(n=110000, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
df_out<-rbind(df_out,profit-loss)
}
return(df_out)
}
pp_sim()
for (i in 10000){
df<-profit_or_pay(n=110000, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out)
}
TYPE='C'
for (i in 10000){
df<-profit_or_pay(n=110000, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out)
}
df_out<-data.frame(profit=double())
for (i in 10000){
df<-profit_or_pay(n=110000, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out)
}
df<-profit_or_pay(n=110000, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
profit
df_out<-rbind(df_out)
View(df_out)
df_out<-rbind(df_out,profit)
df_out<-rbind(df_out,profit)
pp_sim<-function(TYPE='C'){
df_out<-data.frame(profit=double())
for (i in 10000){
df<-profit_or_pay(n=110000, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
return(df_out)
}
pp_sim
pp_sim()
for (i in 10000){
df<-profit_or_pay(n=110000, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
for (i in 1:10000){
df<-profit_or_pay(n=110000, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
df_out<-data.frame(profit=double())
for (i in 1:10000){
df<-profit_or_pay(n=1100, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
df_out<-data.frame(profit=double())
for (i in 1:100){
df<-profit_or_pay(n=1100, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
df_out<-data.frame(profit=double())
for (i in 1:10){
df<-profit_or_pay(n=10, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
df_out<-data.frame(profit=double())
for (i in 1:10){
paste('iter:',i)
df<-profit_or_pay(n=10, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
pp_sim<-function(TYPE='C'){
df_out<-data.frame(profit=double())
for (i in 1:10){
paste('iter:',i)
df<-profit_or_pay(n=10, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
return(df_out)
}
pp_sim()
pp_sim<-function(TYPE='C'){
df_out<-data.frame(profit=double())
for (i in 1:1000){
paste('iter:',i)
df<-profit_or_pay(n=1000, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
return(df_out)
}
df<-pp_sim()
for (i in 1:1000){
print(paste('iter:',i))
df<-profit_or_pay(n=1000, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
pp_sim<-function(TYPE='C'){
df_out<-data.frame(profit=double())
for (i in 1:1000){
print(paste('iter:',i))
df<-profit_or_pay(n=1000, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
return(df_out)
}
df<-pp_sim()
hist(df)
View(df)
hist(df$`sum(bill)`)
mean(df$`sum(bill)`)
#see if you made money or lost money
pp_sim<-function(TYPE='C'){
df_out<-data.frame(profit=double())
for (i in 1:100){
print(paste('iter:',i))
df<-profit_or_pay(n=1000, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
return(df_out)
}
df<-pp_sim()
```{r}
#see if you made money or lost money
pp_sim<-function(TYPE='C'){
df_out<-data.frame(profit=double())
for (i in 1:100){
print(paste('iter:',i))
df<-profit_or_pay(n=1000, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
return(df_out)
}
df<-pp_sim()
#see if you made money or lost money
pp_sim<-function(TYPE='C'){
df_out<-data.frame(profit=double())
for (i in 1:100){
#print(paste('iter:',i))
df<-profit_or_pay(n=1000, TYPE=TYPE)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
return(df_out)
}
df<-pp_sim()
hist(df$`sum(bill)`)
mean(df$`sum(bill)`)
#see if you made money or lost money
pp_sim<-function(TYPE='C', days=d){
df_out<-data.frame(profit=double())
for (i in 1:100){
#print(paste('iter:',i))
df<-profit_or_pay(n=1000, TYPE=TYPE,days=d)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
return(df_out)
}
round(2.11,0)
d=60
d-=1
d+=1
d=d-1
d
day_optimizer<-function(d=60){
df<-pp_sim(days=d)
while(round(mean(df$`sum(bill)`),0)!=0)
if (mean(df$`sum(bill)`)<0){
d=d-1
}else{
d=d+1
}
print(paste('the optimal number of days is:',d))
}
day_optimizer()
day_optimizer<-function(d=60){
df<-pp_sim(days=d)
i=1
while(round(mean(df$`sum(bill)`),0)!=0){
print(paste('iter:',i,'days:',d))
if (mean(df$`sum(bill)`)<0){
d=d-1
}else{
d=d+1
}
i=i+1
}
print(paste('the optimal number of days is:',d))
}
day_optimizer()
day_optimizer<-function(d=60){
print('day optimizer running')
df<-pp_sim(days=d)
i=1
while(round(mean(df$`sum(bill)`),0)!=0){
print(paste('iter:',i,'days:',d))
if (mean(df$`sum(bill)`)<0){
d=d-1
}else{
d=d+1
}
i=i+1
}
print(paste('the optimal number of days is:',d))
}
day_optimizer()
day_optimizer<-function(d=60){
print('day optimizer running')
df<-pp_sim(days=d)
i=1
while(round(mean(df$`sum(bill)`),0)!=0){
print('while loop started')
print(paste('iter:',i,'days:',d))
if (mean(df$`sum(bill)`)<0){
d=d-1
}else{
d=d+1
}
i=i+1
}
print(paste('the optimal number of days is:',d))
}
day_optimizer()
#see if you made money or lost money
pp_sim<-function(TYPE='C', days=d){
df_out<-data.frame(profit=double())
for (i in 1:100){
#print(paste('iter:',i))
df<-profit_or_pay(n=100, TYPE=TYPE,days=d)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
return(df_out)
}
df<-profit_or_pay(TYPE='R')
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit-loss
day_optimizer<-function(d=60){
print('day optimizer running')
df<-pp_sim(days=d)
i=1
while(round(mean(df$`sum(bill)`),0)!=0){
df<-pp_sim(days=d)
print('while loop started')
print(paste('iter:',i,'days:',d))
if (mean(df$`sum(bill)`)<0){
d=d-1
}else{
d=d+1
}
i=i+1
}
print(paste('the optimal number of days is:',d))
}
day_optimizer()
day_optimizer(0)
day_optimizer()
day_optimizer()
#see if you made money or lost money
pp_sim<-function(TYPE='C', days=d){
df_out<-data.frame(profit=double())
for (i in 1:100){
print(paste('iter:',i))
df<-profit_or_pay(n=100, TYPE=TYPE,days=d)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
return(df_out)
}
df<-profit_or_pay(TYPE='R')
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit-loss
day_optimizer<-function(d=60){
print('day optimizer running')
df<-pp_sim(days=d)
i=1
while(round(mean(df$`sum(bill)`),0)!=0){
df<-pp_sim(days=d)
print('while loop started')
print(paste('iter:',i,'days:',d))
if (mean(df$`sum(bill)`)<0){
d=d-1
}else{
d=d+1
}
i=i+1
}
print(paste('the optimal number of days is:',d))
}
day_optimizer()
#see if you made money or lost money
pp_sim<-function(TYPE='C', days=d){
df_out<-data.frame(profit=double())
for (i in 1:100){
#print(paste('iter:',i))
df<-profit_or_pay(n=100, TYPE=TYPE,days=d)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
return(df_out)
}
day_optimizer<-function(d=60){
print('day optimizer running')
df<-pp_sim(days=d)
i=1
while(round(mean(df$`sum(bill)`),0)!=0){
df<-pp_sim(days=d)
print('while loop started')
print(paste('iter:',i,'days:',d))
if (mean(df$`sum(bill)`)<0){
d=d-1
}else{
d=d+1
}
i=i+1
}
print(paste('the optimal number of days is:',d))
}
day_optimizer()
#see if you made money or lost money
pp_sim<-function(TYPE='C', days=d){
df_out<-data.frame(profit=double())
for (i in 1:10){
#print(paste('iter:',i))
df<-profit_or_pay(n=10, TYPE=TYPE,days=d)
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit<-profit-loss
df_out<-rbind(df_out,profit)
}
return(df_out)
}
df<-profit_or_pay(TYPE='R')
profit<-df%>%filter(PROFIT==1)%>%summarise(sum(bill))
loss<-df%>%filter(PROFIT==0)%>%summarise(sum(bill))
profit-loss
day_optimizer<-function(d=60){
print('day optimizer running')
df<-pp_sim(days=d)
i=1
while(round(mean(df$`sum(bill)`),0)!=0){
df<-pp_sim(days=d)
print('while loop started')
print(paste('iter:',i,'days:',d))
if (mean(df$`sum(bill)`)<0){
d=d-1
}else{
d=d+1
}
i=i+1
}
print(paste('the optimal number of days is:',d))
}
day_optimizer()
day_optimizer<-function(d=60){
print('day optimizer running')
df<-pp_sim(days=d)
i=1
while(round(mean(df$`sum(bill)`),0)!=0){
df<-pp_sim(days=d)
print('while loop started')
print(paste('iter:',i,'days:',d))
if (mean(df$`sum(bill)`)<0){
d=d+1
}else{
d=d-1
}
i=i+1
}
print(paste('the optimal number of days is:',d))
}
day_optimizer()
day_optimizer<-function(d=60){
print('day optimizer running')
df<-pp_sim(days=d)
i=1
while(round(mean(df$`sum(bill)`),0)!=0){
df<-pp_sim(days=d)
print('while loop started')
print(paste('iter:',i,'days:',d))
print(mean(df$sum(bill)))
if (mean(df$`sum(bill)`)<0){
d=d+1
}else{
d=d-1
}
i=i+1
}
print(paste('the optimal number of days is:',d))
}
day_optimizer()
day_optimizer<-function(d=60){
print('day optimizer running')
df<-pp_sim(days=d)
i=1
while(round(mean(df$`sum(bill)`),0)!=0){
df<-pp_sim(days=d)
print('while loop started')
print(paste('iter:',i,'days:',d))
print(mean(df$`sum(bill)`))
if (mean(df$`sum(bill)`)<0){
d=d+1
}else{
d=d-1
}
i=i+1
}
print(paste('the optimal number of days is:',d))
}
day_optimizer()
