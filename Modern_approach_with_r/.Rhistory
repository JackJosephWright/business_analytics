ggpairs(dat)
models<-regsubsets(Y~., data = dat, nvmax=4)
summary(models)
res.sum<-summary(models)
data.frame(
Adj.R2 = which.max(res.sum$adjr2),
CP = which.min(res.sum$cp),
BIC = which.min(res.sum$bic)
)
df=data.frame(x=seq(length(res.sum$adjr2)),y=res.sum$adjr2)
ggplot(df, aes(x=x,y=y))+geom_point()+ggtitle('adjusted r^2 by number of predictors')
#look at corrplot
library(corrplot)
corrplot(cor(dat),method = 'number')
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(car)
file<-here('data','MichelinFood.txt')
df<-read.table(file,header = TRUE)
df
df[6,]
ggplot(df, aes(x=Food,y=proportion))+geom_point()
df<-df%>%mutate(logit=log((proportion)/(1-proportion)))
ggplot(df, aes(x=proportion,y=logit))+geom_point()
glm.model<-glm(formula=cbind(InMichelin,NotInMichelin)~Food,family=binomial, data=df)
summary(glm.model)
library(ggResidpanel)
resid_panel(glm.model,plots='all')
range(df$Food)
#create sequence
xFood<-15:28
yFood<-predict(glm.model, list(Food=xFood), type='response')
ggplot(df, aes(x=Food, y=proportion))+geom_point()+geom_smooth(aes(x=xFood,y=yFood))
x<-round(xFood,3)
theta<-round(yFood,3)
odds<-round(yFood/(1-yFood),3)
cbind(x,theta,odds)
y = c(1,1,1,0,0,0)
a <- factor(1:length(y))
fit <- glm(y~a,family=binomial)
summary(fit)
resid_panel(fit)
yY=predict(fit, x=a, type = 'response')
ggplot(as.data.frame(cbind(y,a)), aes(x=a, y=y))+geom_point()+geom_smooth(aes(x=a,y=yY))
summary(glm.model)
pchisq(11.368,df=12, lower.tail = FALSE)
pchisq(50.059,df=1,lower.tail = FALSE)
anova(glm.model,update(glm.model,~1),test='Chisq')
(R_dev=1-11.368/61.427)
library(here)
file<-here('data','MichelinNy.csv')
df<-read.csv(file, header=TRUE)
ggplot(df, aes(x=Food, y=InMichelin))+geom_jitter(height=.1,width=.1)
ggplot(df,aes(x=as.factor(InMichelin),y=Food))+geom_boxplot()
summary(glm.model<-glm(formula=InMichelin~Food, family=binomial(),data=df))
file<-here('data','MichelinFood.txt')
df_1=read.table(file,header = TRUE)
glm.model_crosstab<-glm(formula=cbind(df_1$InMichelin,df_1$NotInMichelin)~Food,family=binomial, data=df_1)
summary(glm.model_crosstab)
anova(glm.model,update(glm.model,~1),test='Chisq')
library(ggpubr)
res_p<-residuals(glm.model,'pearson')
res<-residuals(glm.model)
a<-ggplot(df,aes(x=Food,y=res_p))+geom_point()+ggtitle('Pearson Residuals')
b<-ggplot(df,aes(x=Food,y=res))+geom_point()+ggtitle('standardized Residuals')
ggarrange(b,a)
#example
P_Y_1_x=.6
P_Y_0_x=.4
(theta_x=P_Y_1_x*1+P_Y_0_x*0)
(odds_x=P_Y_1_x/P_Y_0_x)
P_Y_1=mean(df$InMichelin==1)
P_Y_0=1-P_Y_1
df_y_1<-df%>%filter(InMichelin==1)
ggplot(df, aes(x=Food, y=InMichelin))+geom_jitter(height=.1,width=.1)+geom_density(aes(x=Food,y=..density..,color=as.factor(InMichelin),fill=as.factor(InMichelin),alpha=.5))
summary(glm.M_1<-glm(InMichelin~Food, family=binomial(),data=df))
beta_0<-as.numeric(glm.M_1$coefficients[1])
beta_1<-as.numeric(glm.M_1$coefficients[2])
x_1<-df$Food
plot(1/exp(-(beta_0+beta_1*x)))
base<-ggplot(df,aes(x=Food,y=InMichelin))+xlim(15,28)+geom_point()
f<-function(x) (1/(1+exp(-(beta_0+beta_1*x))))
p1<-base+geom_function(fun=f)
library(car)
summary(glm.full<-glm(InMichelin~(Food+Decor+Service+Price),family=binomial(),data=df))
ypredict<-predict(glm.full,type = 'response')
ggplot(df,aes(x=Food,y=ypredict))+geom_point()+geom_smooth(method='loess')+geom_function(fun=f,color='red')
mmps(glm.full)
m <- update(bigmodel, ~. - Age:Start - Number:Start -
glm.full<-update(glm.full,~.+log(Price))
#rerun marginal models
mmps(glm.full_2)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(car)
file<-here('data','MichelinFood.txt')
df<-read.table(file,header = TRUE)
df
df[6,]
ggplot(df, aes(x=Food,y=proportion))+geom_point()
df<-df%>%mutate(logit=log((proportion)/(1-proportion)))
ggplot(df, aes(x=proportion,y=logit))+geom_point()
glm.model<-glm(formula=cbind(InMichelin,NotInMichelin)~Food,family=binomial, data=df)
summary(glm.model)
library(ggResidpanel)
resid_panel(glm.model,plots='all')
range(df$Food)
#create sequence
xFood<-15:28
yFood<-predict(glm.model, list(Food=xFood), type='response')
ggplot(df, aes(x=Food, y=proportion))+geom_point()+geom_smooth(aes(x=xFood,y=yFood))
x<-round(xFood,3)
theta<-round(yFood,3)
odds<-round(yFood/(1-yFood),3)
cbind(x,theta,odds)
y = c(1,1,1,0,0,0)
a <- factor(1:length(y))
fit <- glm(y~a,family=binomial)
summary(fit)
resid_panel(fit)
yY=predict(fit, x=a, type = 'response')
ggplot(as.data.frame(cbind(y,a)), aes(x=a, y=y))+geom_point()+geom_smooth(aes(x=a,y=yY))
summary(glm.model)
pchisq(11.368,df=12, lower.tail = FALSE)
pchisq(50.059,df=1,lower.tail = FALSE)
anova(glm.model,update(glm.model,~1),test='Chisq')
(R_dev=1-11.368/61.427)
library(here)
file<-here('data','MichelinNy.csv')
df<-read.csv(file, header=TRUE)
ggplot(df, aes(x=Food, y=InMichelin))+geom_jitter(height=.1,width=.1)
ggplot(df,aes(x=as.factor(InMichelin),y=Food))+geom_boxplot()
summary(glm.model<-glm(formula=InMichelin~Food, family=binomial(),data=df))
file<-here('data','MichelinFood.txt')
df_1=read.table(file,header = TRUE)
glm.model_crosstab<-glm(formula=cbind(df_1$InMichelin,df_1$NotInMichelin)~Food,family=binomial, data=df_1)
summary(glm.model_crosstab)
anova(glm.model,update(glm.model,~1),test='Chisq')
library(ggpubr)
res_p<-residuals(glm.model,'pearson')
res<-residuals(glm.model)
a<-ggplot(df,aes(x=Food,y=res_p))+geom_point()+ggtitle('Pearson Residuals')
b<-ggplot(df,aes(x=Food,y=res))+geom_point()+ggtitle('standardized Residuals')
ggarrange(b,a)
#example
P_Y_1_x=.6
P_Y_0_x=.4
(theta_x=P_Y_1_x*1+P_Y_0_x*0)
(odds_x=P_Y_1_x/P_Y_0_x)
P_Y_1=mean(df$InMichelin==1)
P_Y_0=1-P_Y_1
df_y_1<-df%>%filter(InMichelin==1)
ggplot(df, aes(x=Food, y=InMichelin))+geom_jitter(height=.1,width=.1)+geom_density(aes(x=Food,y=..density..,color=as.factor(InMichelin),fill=as.factor(InMichelin),alpha=.5))
summary(glm.M_1<-glm(InMichelin~Food, family=binomial(),data=df))
beta_0<-as.numeric(glm.M_1$coefficients[1])
beta_1<-as.numeric(glm.M_1$coefficients[2])
x_1<-df$Food
plot(1/exp(-(beta_0+beta_1*x)))
base<-ggplot(df,aes(x=Food,y=InMichelin))+xlim(15,28)+geom_point()
f<-function(x) (1/(1+exp(-(beta_0+beta_1*x))))
p1<-base+geom_function(fun=f)
library(car)
summary(glm.full<-glm(InMichelin~(Food+Decor+Service+Price),family=binomial(),data=df))
ypredict<-predict(glm.full,type = 'response')
ggplot(df,aes(x=Food,y=ypredict))+geom_point()+geom_smooth(method='loess')+geom_function(fun=f,color='red')
mmps(glm.full)
m <- update(bigmodel, ~. - Age:Start - Number:Start -
glm.full<-update(glm.full,~.+log(Price))
#rerun marginal models
mmps(glm.full_2)
m <- update(bigmodel, ~. - Age:Start - Number:Start -
glm.full<-update(glm.full,~.+log(Price))
#rerun marginal models
mmps(glm.full_2)
m <- update(bigmodel, ~. - Age:Start - Number:Start -
glm.full<-update(glm.full,~.+log(Price))
#rerun marginal models
mmps(glm.full)
m <- update(bigmodel, ~. - Age:Start - Number:Start )
glm.full<-update(glm.full,~.+log(Price))
#rerun marginal models
mmps(glm.full)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
library(car)
file<-here('data','MichelinFood.txt')
df<-read.table(file,header = TRUE)
df
df[6,]
ggplot(df, aes(x=Food,y=proportion))+geom_point()
df<-df%>%mutate(logit=log((proportion)/(1-proportion)))
ggplot(df, aes(x=proportion,y=logit))+geom_point()
glm.model<-glm(formula=cbind(InMichelin,NotInMichelin)~Food,family=binomial, data=df)
summary(glm.model)
library(ggResidpanel)
resid_panel(glm.model,plots='all')
range(df$Food)
#create sequence
xFood<-15:28
yFood<-predict(glm.model, list(Food=xFood), type='response')
ggplot(df, aes(x=Food, y=proportion))+geom_point()+geom_smooth(aes(x=xFood,y=yFood))
x<-round(xFood,3)
theta<-round(yFood,3)
odds<-round(yFood/(1-yFood),3)
cbind(x,theta,odds)
y = c(1,1,1,0,0,0)
a <- factor(1:length(y))
fit <- glm(y~a,family=binomial)
summary(fit)
resid_panel(fit)
yY=predict(fit, x=a, type = 'response')
ggplot(as.data.frame(cbind(y,a)), aes(x=a, y=y))+geom_point()+geom_smooth(aes(x=a,y=yY))
summary(glm.model)
pchisq(11.368,df=12, lower.tail = FALSE)
pchisq(50.059,df=1,lower.tail = FALSE)
anova(glm.model,update(glm.model,~1),test='Chisq')
(R_dev=1-11.368/61.427)
library(here)
file<-here('data','MichelinNy.csv')
df<-read.csv(file, header=TRUE)
ggplot(df, aes(x=Food, y=InMichelin))+geom_jitter(height=.1,width=.1)
ggplot(df,aes(x=as.factor(InMichelin),y=Food))+geom_boxplot()
summary(glm.model<-glm(formula=InMichelin~Food, family=binomial(),data=df))
file<-here('data','MichelinFood.txt')
df_1=read.table(file,header = TRUE)
glm.model_crosstab<-glm(formula=cbind(df_1$InMichelin,df_1$NotInMichelin)~Food,family=binomial, data=df_1)
summary(glm.model_crosstab)
anova(glm.model,update(glm.model,~1),test='Chisq')
library(ggpubr)
res_p<-residuals(glm.model,'pearson')
res<-residuals(glm.model)
a<-ggplot(df,aes(x=Food,y=res_p))+geom_point()+ggtitle('Pearson Residuals')
b<-ggplot(df,aes(x=Food,y=res))+geom_point()+ggtitle('standardized Residuals')
ggarrange(b,a)
#example
P_Y_1_x=.6
P_Y_0_x=.4
(theta_x=P_Y_1_x*1+P_Y_0_x*0)
(odds_x=P_Y_1_x/P_Y_0_x)
P_Y_1=mean(df$InMichelin==1)
P_Y_0=1-P_Y_1
df_y_1<-df%>%filter(InMichelin==1)
ggplot(df, aes(x=Food, y=InMichelin))+geom_jitter(height=.1,width=.1)+geom_density(aes(x=Food,y=..density..,color=as.factor(InMichelin),fill=as.factor(InMichelin),alpha=.5))
summary(glm.M_1<-glm(InMichelin~Food, family=binomial(),data=df))
beta_0<-as.numeric(glm.M_1$coefficients[1])
beta_1<-as.numeric(glm.M_1$coefficients[2])
x_1<-df$Food
plot(1/exp(-(beta_0+beta_1*x)))
base<-ggplot(df,aes(x=Food,y=InMichelin))+xlim(15,28)+geom_point()
f<-function(x) (1/(1+exp(-(beta_0+beta_1*x))))
p1<-base+geom_function(fun=f)
library(car)
summary(glm.full<-glm(InMichelin~(Food+Decor+Service+Price),family=binomial(),data=df))
ypredict<-predict(glm.full,type = 'response')
ggplot(df,aes(x=Food,y=ypredict))+geom_point()+geom_smooth(method='loess')+geom_function(fun=f,color='red')
mmps(glm.full)
m <- update(bigmodel, ~. - Age:Start - Number:Start )
glm.full<-update(glm.full,~.+log(Price))
#rerun marginal models
mmps(glm.full)
ggplot(df%>%group_by(InMichelin),aes(x=Decor,y=Service, color=factor(InMichelin)))+geom_point()+geom_smooth(method='lm', se=FALSE)
glm.full_2<-glm(InMichelin~Food+Decor+Service+Price+log(Price)+Service:Decor, family=binomial(),data=df)
mmps(glm.full_2)
#mmps(m,span=3/4, layout = c(2,2))
Anova(m1 <- update(m, ~. + I(Age^2)))
mmps(m1, span = 3/4)
library(car)
anova(glm.full,glm.full_2)
pchisq(6.61,1,lower.tail = FALSE)
resid_interact(glm.full_2, plots='lev')
summary(glm.full_2)
glm.2<-glm.full_2
glm.3<-update(glm.2,~.-Price)
#compare with anova
anova(glm.3,glm.2)
pchisq(1.4,1,lower.tail=FALSE)
summary(glm.3)
mmps(glm.3)
summary(glm.M_1<-glm(InMichelin~Food, family=binomial(),data=df))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
file<-here('data','MichelinFood.txt')
df<-read.table(file,header = TRUE)
df
df[6,]
ggplot(df, aes(x=Food,y=proportion))+geom_point()
df<-df%>%mutate(logit=log((proportion)/(1-proportion)))
ggplot(df, aes(x=proportion,y=logit))+geom_point()
glm.model<-glm(formula=cbind(InMichelin,NotInMichelin)~Food,family=binomial, data=df)
summary(glm.model)
library(ggResidpanel)
resid_panel(glm.model,plots='all')
range(df$Food)
#create sequence
xFood<-15:28
yFood<-predict(glm.model, list(Food=xFood), type='response')
ggplot(df, aes(x=Food, y=proportion))+geom_point()+geom_smooth(aes(x=xFood,y=yFood))
x<-round(xFood,3)
theta<-round(yFood,3)
odds<-round(yFood/(1-yFood),3)
cbind(x,theta,odds)
y = c(1,1,1,0,0,0)
a <- factor(1:length(y))
fit <- glm(y~a,family=binomial)
summary(fit)
resid_panel(fit)
yY=predict(fit, x=a, type = 'response')
ggplot(as.data.frame(cbind(y,a)), aes(x=a, y=y))+geom_point()+geom_smooth(aes(x=a,y=yY))
summary(glm.model)
pchisq(11.368,df=12, lower.tail = FALSE)
pchisq(50.059,df=1,lower.tail = FALSE)
anova(glm.model,update(glm.model,~1),test='Chisq')
(R_dev=1-11.368/61.427)
library(here)
file<-here('data','MichelinNy.csv')
df<-read.csv(file, header=TRUE)
ggplot(df, aes(x=Food, y=InMichelin))+geom_jitter(height=.1,width=.1)
ggplot(df,aes(x=as.factor(InMichelin),y=Food))+geom_boxplot()
summary(glm.model<-glm(formula=InMichelin~Food, family=binomial(),data=df))
file<-here('data','MichelinFood.txt')
df_1=read.table(file,header = TRUE)
glm.model_crosstab<-glm(formula=cbind(df_1$InMichelin,df_1$NotInMichelin)~Food,family=binomial, data=df_1)
summary(glm.model_crosstab)
anova(glm.model,update(glm.model,~1),test='Chisq')
library(ggpubr)
res_p<-residuals(glm.model,'pearson')
res<-residuals(glm.model)
a<-ggplot(df,aes(x=Food,y=res_p))+geom_point()+ggtitle('Pearson Residuals')
b<-ggplot(df,aes(x=Food,y=res))+geom_point()+ggtitle('standardized Residuals')
ggarrange(b,a)
#example
P_Y_1_x=.6
P_Y_0_x=.4
(theta_x=P_Y_1_x*1+P_Y_0_x*0)
(odds_x=P_Y_1_x/P_Y_0_x)
P_Y_1=mean(df$InMichelin==1)
P_Y_0=1-P_Y_1
df_y_1<-df%>%filter(InMichelin==1)
ggplot(df, aes(x=Food, y=InMichelin))+geom_jitter(height=.1,width=.1)+geom_density(aes(x=Food,y=..density..,color=as.factor(InMichelin),fill=as.factor(InMichelin),alpha=.5))
summary(glm.M_1<-glm(InMichelin~Food, family=binomial(),data=df))
beta_0<-as.numeric(glm.M_1$coefficients[1])
beta_1<-as.numeric(glm.M_1$coefficients[2])
x_1<-df$Food
plot(1/exp(-(beta_0+beta_1*x)))
base<-ggplot(df,aes(x=Food,y=InMichelin))+xlim(15,28)+geom_point()
f<-function(x) (1/(1+exp(-(beta_0+beta_1*x))))
p1<-base+geom_function(fun=f)
library(car)
summary(glm.full<-glm(InMichelin~(Food+Decor+Service+Price),family=binomial(),data=df))
ypredict<-predict(glm.full,type = 'response')
ggplot(df,aes(x=Food,y=ypredict))+geom_point()+geom_smooth(method='loess')+geom_function(fun=f,color='red')
mmps(glm.full)
m <- update(bigmodel, ~. - Age:Start - Number:Start -
glm.full<-update(glm.full,~.+log(Price))
#rerun marginal models
mmps(glm.full_2)
gc()
gc()
gc()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
file<-here('data','MichelinFood.txt')
df<-read.table(file,header = TRUE)
df
df[6,]
ggplot(df, aes(x=Food,y=proportion))+geom_point()
df<-df%>%mutate(logit=log((proportion)/(1-proportion)))
ggplot(df, aes(x=proportion,y=logit))+geom_point()
glm.model<-glm(formula=cbind(InMichelin,NotInMichelin)~Food,family=binomial, data=df)
summary(glm.model)
library(ggResidpanel)
resid_panel(glm.model,plots='all')
range(df$Food)
#create sequence
xFood<-15:28
yFood<-predict(glm.model, list(Food=xFood), type='response')
ggplot(df, aes(x=Food, y=proportion))+geom_point()+geom_smooth(aes(x=xFood,y=yFood))
x<-round(xFood,3)
theta<-round(yFood,3)
odds<-round(yFood/(1-yFood),3)
cbind(x,theta,odds)
y = c(1,1,1,0,0,0)
a <- factor(1:length(y))
fit <- glm(y~a,family=binomial)
summary(fit)
resid_panel(fit)
yY=predict(fit, x=a, type = 'response')
ggplot(as.data.frame(cbind(y,a)), aes(x=a, y=y))+geom_point()+geom_smooth(aes(x=a,y=yY))
summary(glm.model)
pchisq(11.368,df=12, lower.tail = FALSE)
pchisq(50.059,df=1,lower.tail = FALSE)
anova(glm.model,update(glm.model,~1),test='Chisq')
(R_dev=1-11.368/61.427)
library(here)
file<-here('data','MichelinNy.csv')
df<-read.csv(file, header=TRUE)
ggplot(df, aes(x=Food, y=InMichelin))+geom_jitter(height=.1,width=.1)
ggplot(df,aes(x=as.factor(InMichelin),y=Food))+geom_boxplot()
summary(glm.model<-glm(formula=InMichelin~Food, family=binomial(),data=df))
file<-here('data','MichelinFood.txt')
df_1=read.table(file,header = TRUE)
glm.model_crosstab<-glm(formula=cbind(df_1$InMichelin,df_1$NotInMichelin)~Food,family=binomial, data=df_1)
summary(glm.model_crosstab)
anova(glm.model,update(glm.model,~1),test='Chisq')
library(ggpubr)
res_p<-residuals(glm.model,'pearson')
res<-residuals(glm.model)
a<-ggplot(df,aes(x=Food,y=res_p))+geom_point()+ggtitle('Pearson Residuals')
b<-ggplot(df,aes(x=Food,y=res))+geom_point()+ggtitle('standardized Residuals')
ggarrange(b,a)
#example
P_Y_1_x=.6
P_Y_0_x=.4
(theta_x=P_Y_1_x*1+P_Y_0_x*0)
(odds_x=P_Y_1_x/P_Y_0_x)
P_Y_1=mean(df$InMichelin==1)
P_Y_0=1-P_Y_1
df_y_1<-df%>%filter(InMichelin==1)
ggplot(df, aes(x=Food, y=InMichelin))+geom_jitter(height=.1,width=.1)+geom_density(aes(x=Food,y=..density..,color=as.factor(InMichelin),fill=as.factor(InMichelin),alpha=.5))
summary(glm.M_1<-glm(InMichelin~Food, family=binomial(),data=df))
beta_0<-as.numeric(glm.M_1$coefficients[1])
beta_1<-as.numeric(glm.M_1$coefficients[2])
x_1<-df$Food
plot(1/exp(-(beta_0+beta_1*x)))
base<-ggplot(df,aes(x=Food,y=InMichelin))+xlim(15,28)+geom_point()
f<-function(x) (1/(1+exp(-(beta_0+beta_1*x))))
p1<-base+geom_function(fun=f)
library(car)
summary(glm.full<-glm(InMichelin~(Food+Decor+Service+Price),family=binomial(),data=df))
ypredict<-predict(glm.full,type = 'response')
ggplot(df,aes(x=Food,y=ypredict))+geom_point()+geom_smooth(method='loess')+geom_function(fun=f,color='red')
mmps(glm.full)
m <- update(bigmodel, ~. - Age:Start - Number:Start -
glm.full<-update(glm.full,~.+log(Price))
#rerun marginal models
mmps(glm.full_2)
library(here)
file<-here('data','MichelinNy.csv')
df<-read.csv(file, header=TRUE)
ggplot(df, aes(x=Food, y=InMichelin))+geom_jitter(height=.1,width=.1)
ggplot(df,aes(x=as.factor(InMichelin),y=Food))+geom_boxplot()
summary(glm.model<-glm(formula=InMichelin~Food, family=binomial(),data=df))
file<-here('data','MichelinFood.txt')
df_1=read.table(file,header = TRUE)
glm.model_crosstab<-glm(formula=cbind(df_1$InMichelin,df_1$NotInMichelin)~Food,family=binomial, data=df_1)
summary(glm.model_crosstab)
anova(glm.model,update(glm.model,~1),test='Chisq')
library(ggpubr)
res_p<-residuals(glm.model,'pearson')
res<-residuals(glm.model)
a<-ggplot(df,aes(x=Food,y=res_p))+geom_point()+ggtitle('Pearson Residuals')
b<-ggplot(df,aes(x=Food,y=res))+geom_point()+ggtitle('standardized Residuals')
ggarrange(b,a)
#example
P_Y_1_x=.6
P_Y_0_x=.4
(theta_x=P_Y_1_x*1+P_Y_0_x*0)
(odds_x=P_Y_1_x/P_Y_0_x)
P_Y_1=mean(df$InMichelin==1)
P_Y_0=1-P_Y_1
df_y_1<-df%>%filter(InMichelin==1)
ggplot(df, aes(x=Food, y=InMichelin))+geom_jitter(height=.1,width=.1)+geom_density(aes(x=Food,y=..density..,color=as.factor(InMichelin),fill=as.factor(InMichelin),alpha=.5))
summary(glm.M_1<-glm(InMichelin~Food, family=binomial(),data=df))
beta_0<-as.numeric(glm.M_1$coefficients[1])
beta_1<-as.numeric(glm.M_1$coefficients[2])
x_1<-df$Food
plot(1/exp(-(beta_0+beta_1*x)))
base<-ggplot(df,aes(x=Food,y=InMichelin))+xlim(15,28)+geom_point()
f<-function(x) (1/(1+exp(-(beta_0+beta_1*x))))
p1<-base+geom_function(fun=f)
library(car)
summary(glm.full<-glm(InMichelin~(Food+Decor+Service+Price),family=binomial(),data=df))
ypredict<-predict(glm.full,type = 'response')
ggplot(df,aes(x=Food,y=ypredict))+geom_point()+geom_smooth(method='loess')+geom_function(fun=f,color='red')
mmps(glm.full)
m <- update(bigmodel, ~. - Age:Start - Number:Start -
glm.full<-update(glm.full,~.+log(Price))
#rerun marginal models
mmps(glm.full_2)
summary(glm.full)
ggplot(df%>%group_by(InMichelin),aes(x=Decor,y=Service, color=factor(InMichelin)))+geom_point()+geom_smooth(method='lm', se=FALSE)
mmps(m,span=3/4, layout = c(2,2))
ggplot(df%>%group_by(InMichelin),aes(x=Decor,y=Service, ))+geom_point()+geom_smooth(method='lm', se=TRUE)
ggplot(df%>%group_by(InMichelin),aes(x=Decor,y=Service, ))+geom_point()+geom_smooth(method='loess', se=TRUE)
ggplot(df%>%group_by(InMichelin),aes(x=Decor,y=Service, ))+geom_point()+geom_smooth(method='lm', se=TRUE)
ggplot(df%>%group_by(InMichelin),aes(x=Decor,y=Service,color=factor(InMichelin) ))+geom_point()+geom_smooth(method='lm', se=TRUE)
knitr::opts_chunk$set(echo = TRUE)
file<-here('data','cleaningwtd.txt')
library(tidyverse)
library(here)
df<-read.csv(file,header=TRUE)
file<-here('data','cleaningwtd.txt')
df<-read.csv(file,header=TRUE)
View(df)
df<-read.table(file,header=TRUE)
View(df)
(lm(formula=Rooms~Crews,weights=1/StdDev^2),data=df)
(lm(formula=Rooms~Crews,weights=1/StdDev^2,data=df)
(lm(formula=Rooms~Crews,weights=1/StdDev^2,data=df)
(lm(formula=Rooms~Crews,weights=1/StdDev^2,data=df))
(lm(formula=Rooms~Crews,weights=1/StdDev^2,data=df))
(lm(formula=Rooms~Crews,weights=1/StdDev^2,data=df))
summary(lm(formula=Rooms~Crews,weights=1/StdDev^2,data=df))
summary(lm(formula=Rooms~Crews,weights=2/StdDev^2,data=df))
summary(lm(formula=Rooms~Crews,weights=4/StdDev^2,data=df))
summary(lm(formula=Rooms~Crews,weights=100/StdDev^2,data=df))
summary(lm(formula=Rooms~Crews,weights=1/StdDev^2,data=df))
