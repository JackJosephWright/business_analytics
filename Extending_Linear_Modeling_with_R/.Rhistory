summary(glm_list[['quasi']])
summary(glm_list[['All']])
summary(glm_list[['quasi']])
summary(glm_list[['All']],dispersion=2.43)
anova(glm_list[['quasi']],test='F')
ships2<-ships
glm1 <- glm(incidents ~ type + year + period,
family = poisson(link = "log"), data = ships2, offset = log(service))
summary(glm1)
par(mfrow=c(2,2))
plot(glm1)
resid_panel(glm1)
glm2 <- update(glm1, family = quasipoisson(link = "log"))
summary(glm2)
resid_panel(glm2)
ships2<-ships
glm1 <- glm(incidents ~ type + year + period,
family = poisson(link = "log"), data = ships2, offset = log(service))
summary(glm1)
par(mfrow=c(2,2))
resid_panel(glm1)
anova(glm2, test = "F")
# check if damage is roughly proportional to service
glm3 <- glm(formula = incidents ~ type + year + period + log(service),
family = quasipoisson(link = "log"), data = ships2)
summary(glm3)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(MASS)
library(ggResidpanel)
library(GGally)
library(tidyverse)
library(MASS)
library(ggResidpanel)
library(GGally)
library(faraway)
night_owlish <- "https://raw.githubusercontent.com/batpigandme/night-owlish/master/rstheme/night-owlish.rstheme"
rstudioapi::addTheme(night_owlish, apply = TRUE)
africa<-data(africa)
summary(africa)
africa<-data(africa)
summary(africa)
library(tidyverse)
library(MASS)
library(ggResidpanel)
library(GGally)
library(faraway)
africa<-data(africa)
summary(africa)
data(africa)
summary(africa)
af_na<-africa%>%mutate(is_na=case_when(is.na(pollib)))
af_na<-africa%>%case_when(is.na(pollib))
af_na<-africa%>%case_when(is.na(pctvote))
af_na<-africa%>%case_when(is.na(pctvote),~TRUE)
africa
is.na(africa$pollib)
africa%>%mutate(
has_na = case_when(is.na(pollib)|is.na(pctvote)~TRUE,
TRUE~FALSE
)
)
af_na<-africa%>%mutate(
has_na = case_when(is.na(pollib)|is.na(pctvote)~TRUE,
TRUE~FALSE
)
)
ggpairs(af_na,mapping=has_na)
ggpairs(af_na,aes(colour = has_na, alpha = 0.4)))
ggpairs(af_na,aes(colour = has_na, alpha = 0.4))
ggpairs(af_na,aes(colour = has_na, alpha = 0.4))
africa<-na.omit(africa)
glm_list=list()
glm_list[['All']]<-glm(data=africa,militcoup~.,family=poisson())
glm_list=list()
glm_list[['All']]<-glm(data=africa,miltcoup~.,family=poisson())
glm_list=list()
glm_list[['All']]<-glm(data=africa,miltcoup~.,family=poisson())
glm_list[['Quasi']]<-glm(data=africa,miltcoup~.family=quasipoisson())
glm_list=list()
glm_list[['All']]<-glm(data=africa,miltcoup~.,family=poisson())
glm_list[['Quasi']]<-glm(data=africa,miltcoup~.,family=quasipoisson())
glm_list[['nb']]<-glm.nb(data=africa,miltcoup~.)
lapply(glm_list,
FUN=summary
)
glm_list=list()
glm_list[['All']]<-glm(data=africa,miltcoup~oligarchy+pollib+parties,family=poisson())
glm_list[['Quasi']]<-glm(data=africa,miltcoup~oligarchy+pollib+parties,family=quasipoisson())
glm_list[['nb']]<-glm.nb(data=africa,miltcoup~oligarchy+pollib+parties)
lapply(glm_list,
FUN=summary
)
glm_list=list()
glm_list[['All']]<-glm(data=africa,miltcoup~.,family=poisson())
glm_list[['Quasi']]<-glm(data=africa,miltcoup~.,family=quasipoisson())
glm_list[['nb']]<-glm.nb(data=africa,miltcoup~.)
glm_list[['Selected']]<-glm(data=africa,miltcoup~oligarchy+pollib+parties,family=poisson())
glm_list[['Quasi_selected']]<-glm(data=africa,miltcoup~oligarchy+pollib+parties,family=quasipoisson())
glm_list[['nb_selected']]<-glm.nb(data=africa,miltcoup~oligarchy+pollib+parties)
lapply(
X=list_glm,
FUN = AIC
)
lapply(
X=glm_list,
FUN = AIC
)
View(africa)
drop1(glm_list[['All']])
drop1(glm_list[['All']],test='F')
resid_panel(glm_list[['Selected']])
ggpairs(africa%>%select(oligarchy,pollib,parties))
ggpairs(africa%>%select(c(oligarchy,pollib,parties)))
africa%>%select(c(oligarchy,pollib,parties)
africa%>%select(c(oligarchy,pollib,parties))
africa%>%select(c(oligarchy,pollib,parties))
africa
africa%>%select(oligarchy)
data(africa)
summary(africa)
library(tidyverse)
library(MASS)
library(ggResidpanel)
library(GGally)
library(faraway)
View(africa)
View(af_na)
View(africa)
View(af_na)
africa%>%select(oligarchy)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(MASS)
library(ggResidpanel)
library(GGally)
library(faraway)
data(africa)
summary(africa)
starwars %>%
select(name:mass, gender, species) %>%
mutate(
type = case_when(
height > 200 | mass > 200 ~ "large",
species == "Droid"        ~ "robot",
TRUE                      ~ "other"
)
)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(MASS)
library(ggResidpanel)
library(GGally)
library(faraway)
data(africa)
summary(africa)
af_na<-africa%>%mutate(
has_na = case_when(is.na(pollib)|is.na(pctvote)~TRUE,
TRUE~FALSE
)
)
ggpairs(af_na,aes(colour = has_na, alpha = 0.4))
africa<-na.omit(africa)
glm_list=list()
glm_list[['All']]<-glm(data=africa,miltcoup~.,family=poisson())
glm_list[['Quasi']]<-glm(data=africa,miltcoup~.,family=quasipoisson())
glm_list[['nb']]<-glm.nb(data=africa,miltcoup~.)
lapply(glm_list,
FUN=summary
)
glm_list=list()
glm_list[['All']]<-glm(data=africa,miltcoup~.,family=poisson())
glm_list[['Quasi']]<-glm(data=africa,miltcoup~.,family=quasipoisson())
glm_list[['nb']]<-glm.nb(data=africa,miltcoup~.)
glm_list[['Selected']]<-glm(data=africa,miltcoup~oligarchy+pollib+parties,family=poisson())
glm_list[['Quasi_selected']]<-glm(data=africa,miltcoup~oligarchy+pollib+parties,family=quasipoisson())
glm_list[['nb_selected']]<-glm.nb(data=africa,miltcoup~oligarchy+pollib+parties)
lapply(
X=glm_list,
FUN = AIC
)
drop1(glm_list[['All']],test='F')
resid_panel(glm_list[['Selected']])
ggpairs())
africa%>%select(c(oligarchy,pollib,parties))
africa%>%select(oligarchy)
df<-africa
df%>%select(oligarchy)
df%>%select(-oligarchy)
df%>%dplyr::select(-oligarchy)
ggpairs(dplyr::select(c(oligarchy,pollib,parties)))
ggpairs(africa%>%dplyr::select(c(oligarchy,pollib,parties)))
ggpairs(africa%>%dplyr::select(c(miltcoup,oligarchy,pollib,parties)))
resid_panel(glm_list[['Selected']],plots='all')
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,2),family=poisson())
summary(glm_final)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,4),family=poisson())
summary(glm_final)
resid_panel(glm_final)
ggplot(africa,aes(x=miltcoup,y=glm_final$fitted.values))+geom_point()
resid_panel(glm_final)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,3),family=poisson())
summary(glm_final)
ggplot(africa,aes(x=miltcoup,y=glm_final$fitted.values))+geom_point()
resid_panel(glm_final)
ggplot(africa,aes(x=miltcoup,y=glm_final$fitted.values))+geom_point()+geom_abline(slope=1,intercept = 0)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,3),family=quasipoisson())
summary(glm_final)
ggplot(africa,aes(x=miltcoup,y=glm_final$fitted.values))+geom_point()+geom_abline(slope=1,intercept = 0)
resid_panel(glm_final)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,3),family=poisson)
summary(glm_final)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(MASS)
library(ggResidpanel)
library(GGally)
library(faraway)
data(africa)
summary(africa)
af_na<-africa%>%mutate(
has_na = case_when(is.na(pollib)|is.na(pctvote)~TRUE,
TRUE~FALSE
)
)
ggpairs(af_na,aes(colour = has_na, alpha = 0.4))
africa<-na.omit(africa)
glm_list=list()
glm_list[['All']]<-glm(data=africa,miltcoup~.,family=poisson())
glm_list[['Quasi']]<-glm(data=africa,miltcoup~.,family=quasipoisson())
glm_list[['nb']]<-glm.nb(data=africa,miltcoup~.)
lapply(glm_list,
FUN=summary
)
glm_list=list()
glm_list[['All']]<-glm(data=africa,miltcoup~.,family=poisson())
glm_list[['Quasi']]<-glm(data=africa,miltcoup~.,family=quasipoisson())
glm_list[['nb']]<-glm.nb(data=africa,miltcoup~.)
glm_list[['Selected']]<-glm(data=africa,miltcoup~oligarchy+pollib+parties,family=poisson())
glm_list[['Quasi_selected']]<-glm(data=africa,miltcoup~oligarchy+pollib+parties,family=quasipoisson())
glm_list[['nb_selected']]<-glm.nb(data=africa,miltcoup~oligarchy+pollib+parties)
lapply(
X=glm_list,
FUN = AIC
)
drop1(glm_list[['All']],test='F')
resid_panel(glm_list[['Selected']],plots='all')
ggpairs(africa%>%dplyr::select(c(miltcoup,oligarchy,pollib,parties)))
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,3),family=poisson)
summary(glm_final)
ggplot(africa,aes(x=miltcoup,y=glm_final$fitted.values))+geom_point()+geom_abline(slope=1,intercept = 0)
resid_panel(glm_final)
ggplot(africa,aes(x=miltcoup,y=glm_final$fitted.values))+geom_point()+geom_abline(slope=1,intercept = 0)
ggplot(africa,aes(x=miltcoup,y=glm_final$residuals))+geom_point()+geom_abline(slope=1,intercept = 0)
ggplot(africa,aes(x=miltcoup,y=glm_final$residuals))+geom_point()+geom_abline(slope=0,intercept = 0)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,4),family=poisson)
summary(glm_final)
ggplot(africa,aes(x=miltcoup,y=glm_final$residuals))+geom_point()+geom_abline(slope=0,intercept = 0)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,1),family=poisson)
summary(glm_final)
ggplot(africa,aes(x=miltcoup,y=glm_final$residuals))+geom_point()+geom_abline(slope=0,intercept = 0)
ggplot(africa,aes(x=glm_final$fitted.values,y=glm_final$residuals))+geom_point()+geom_abline(slope=0,intercept = 0)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,2),family=poisson)
summary(glm_final)
ggplot(africa,aes(x=glm_final$fitted.values,y=glm_final$residuals))+geom_point()+geom_abline(slope=0,intercept = 0)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,3),family=poisson)
summary(glm_final)
ggplot(africa,aes(x=glm_final$fitted.values,y=glm_final$residuals))+geom_point()+geom_abline(slope=0,intercept = 0)
glm_final<-glm(data=africa,miltcoup~log(poly(oligarchy,3)),family=poisson)
summary(glm_final)
ggplot(africa,aes(x=glm_final$fitted.values,y=glm_final$residuals))+geom_point()+geom_abline(slope=0,intercept = 0)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,3),family=poisson)
summary(glm_final)
ggplot(africa,aes(x=glm_final$fitted.values,y=glm_final$residuals))+geom_point()+geom_abline(slope=0,intercept = 0)
ggplot(africa,aes(x=sqrt(glm_final$fitted.values),y=glm_final$residuals))+geom_point()+geom_abline(slope=0,intercept = 0)
ggplot(africa,aes(x=glm_final$fitted.values,y=sqrt(glm_final$residuals)))+geom_point()+geom_abline(slope=0,intercept = 0)
ggplot(africa,aes(x=glm_final$fitted.values,y=glm_final$residuals^2))+geom_point()+geom_abline(slope=0,intercept = 0)
ggplot(africa,aes(x=glm_final$fitted.values,y=glm_final$residuals))+geom_point()+geom_abline(slope=0,intercept = 0)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,3)),family=quasipoisson()
summary(glm_final)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,3)),family=quasipoisson())
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,3),family=quasipoisson())
summary(glm_final)
ggplot(africa,aes(x=glm_final$fitted.values,y=glm_final$residuals))+geom_point()+geom_abline(slope=0,intercept = 0)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,3),)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,3),family=poisson)
summary(glm_final)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,1),family=poisson)
summary(glm_final)
ggplot(africa,aes(x=glm_final$fitted.values,y=glm_final$residuals))+geom_point()+geom_abline(slope=0,intercept = 0)
glm_final<-glm(data=africa,miltcoup~poly(oligarchy,3),family=poisson)
summary(glm_final)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(MASS)
library(ggResidpanel)
library(GGally)
library(faraway)
data("dvisits")
view(dvisits)
View(dvisits)
mod1<-glm(data=dvisits, doctorco~sex+ age+
agesq+ income+ levyplus+ freepoor+ freerepa+ illness+ actdays+ hscore+ chcond1+chond2, family=poisson)
mod1<-glm(data=dvisits, doctorco~sex+ age+
agesq+ income+ levyplus+ freepoor+ freerepa+ illness+ actdays+ hscore+ chcond1+chcond2, family=poisson)
summary(mod1)
pchisq(4379.5,5117,lower.tail = FALSE)
pchisq(5634.8-4379
5,5189-5177,lower.tail = FALSE)
pchisq(5634.8-4379.5,5189-5177,lower.tail = FALSE)
resid_panel(mod1)
mod1<-glm(data=dvisits, doctorco~sex+ age+
agesq+ income+ levyplus+ freepoor+ freerepa+ illness+ actdays+ hscore+ chcond1+chcond2, family=poisson)
summary(mod1)
mod1<-glm(data=dvisits, doctorco~sex+ age+ income+ levyplus+ freepoor+ freerepa+ illness+ actdays+ hscore+ chcond1+chcond2, family=poisson)
summary(mod1)
mod1<-glm(data=dvisits, doctorco~sex+ age+ income+ levyplus+ freepoor+ illness+ actdays+ hscore+ chcond1+chcond2, family=poisson)
summary(mod1)
mod1<-glm(data=dvisits, doctorco~sex+ age+ income+ freepoor+ illness+ actdays+ hscore+ chcond1+chcond2, family=poisson)
summary(mod1)
mod1<-glm(data=dvisits, doctorco~sex+ age+ income+ freepoor+ illness+ actdays+ hscore+chcond2, family=poisson)
summary(mod1)
mod1<-glm(data=dvisits, doctorco~sex+ age+ income+ freepoor+ illness+ actdays+ hscore, family=poisson)
summary(mod1)
mod1<-glm(data=dvisits, doctorco~sex+ age+ freepoor+ illness+ actdays+ hscore, family=poisson)
summary(mod1)
mod1<-glm(data=dvisits, doctorco~sex+ age+ illness+ actdays+ hscore, family=poisson)
summary(mod1)
mod1<-glm(data=dvisits, doctorco~sex+ age+ illness+ actdays, family=poisson)
summary(mod1)
mod1<-glm(data=dvisits, doctorco~ age+ illness+ actdays, family=poisson)
summary(mod1)
mod1<-glm(data=dvisits, doctorco~  illness+ actdays, family=poisson)
summary(mod1)
mod1<-glm(data=dvisits, doctorco~  illness+ actdays, family=poisson)
summary(mod1)
resid_panel(mod1)
mod1<-glm(data=dvisits, doctorco~  illness+ actdays, family=poisson)
summary(mod1)
mod1<-glm(data=dvisits, doctorco~  illness, family=poisson)
summary(mod1)
mod1<-glm(data=dvisits, doctorco~  illness+ actdays, family=poisson)
summary(mod1)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(MASS)
library(ggResidpanel)
library(GGally)
library(faraway)
data("dvisits")
mod1<-glm(data=dvisits, doctorco~sex+ age+
agesq+ income+ levyplus+ freepoor+ freerepa+ illness+ actdays+ hscore+ chcond1+chcond2, family=poisson)
summary(mod1)
pchisq(5634.8-4379.5,5189-5177,lower.tail = FALSE)
resid_panel(mod1)
mod_back<-glm(data=dvisits, doctorco~  illness+ actdays, family=poisson)
summary(mod_back)
drop1(mod1)
drop1(mod1,test='F')
step(mod1,direction = 'backward')
knitr::opts_chunk$set(echo = TRUE)
library(faraway)
install.packages('faraway')
knitr::opts_chunk$set(echo = TRUE)
library(faraway)
data(orings)
plot (damage/6 ~ temp, orings, xlim=c(25,85), ylim =
c(0,1),
xlab="Temperature", ylab="Prob of damage")
library(tidyverse)
ggplot(orings, aes(y=damage/6,x=temp))+geom_point()+xlab('Temperature')+ylab('Prob of Damage')
lmod<-lm(damage/6~temp, orings)
library(ggResidpanel)
ggplot(orings, aes(x=temp,y=damage/6))+geom_point()+geom_smooth(method='lm', se=FALSE)
summary(lmod)
logitmod<-glm(cbind(damage,6-damage)~temp, family=binomial(), data=orings)
summary(logitmod)
pchisq(16.912, 21, lower=FALSE)
library(car)
mmps(logitmod)
plot (damage/6 ~ temp, orings, xlim=c(25,85),
ylim=c(0,1),
xlab="Temperature", ylab="Prob of damage")
x <- seq(25,85,1)
lines(x,ilogit(11.6630−0.2162*x))
probitmod<-glm(cbind(damage,6-damage)~temp, family=binomial(link=probit),orings)
summary(probitmod)
plot (damage/6 ~ temp, orings, xlim=c(25,85),
ylim=c(0,1),
xlab="Temperature", ylab="Prob of damage")
x <- seq(25,85,1)
lines(x,ilogit(11.6630−0.2162*x))
lines(x, pnorm(5.5915-0.1058*x), lty=2)
l<-ilogit (11.6630-0.2162*31)
p<-pnorm(5.5915-0.1058*31)
cat('logit estimation at 31F:',l,'\nProbit estimation at 31F:',p)
pchisq(deviance(logitmod), df.residual(logitmod),lower=FALSE)
pchisq(38.9,22,lower=FALSE)
dev_dif<-(38.9-16.9)
pchisq(dev_dif,1,lower=FALSE)
library(MASS)
confint(logitmod)
library(kableExtra)
View(orings)
install.packages('kableExtra')
library(kableExtra)
data("babyfood")
xtabs(disease/(disease+nondisease)~sex+food, babyfood)%>%kbl()%>%kable_classic()
mdl<-glm(cbind(disease,nondisease)~sex+food, family = binomial(), babyfood)
summary(mdl)
drop1(mdl,test="Chi")
exp(mdl$coefficients[3])
confint(mdl)
exp(confint(mdl))%>%kbl%>%kable_classic()
#log odds for SUPPLIMENT to have  lower disease than bottle feeding
log_odds<-(-.173)
1-exp(-0.17)
a<-babyfood[c(1,3),]
a<-a%>%mutate(log_odds=log(disease/nondisease),.before=sex)
a%>%kbl%>%kable_classic()
data(bliss)
bliss
mod1<-glm(cbind(dead,alive)~conc,family=binomial(),data=bliss)
modp <- glm(cbind(dead, alive) ~ conc,
family=binomial(link=probit),
data=bliss)
modc<-glm(cbind(dead, alive) ~ conc,
family=binomial(link=cloglog),
data=bliss)
fitted(mod1)
predict (mod1, type='response')
#take the logit, because the predictors are from the logit function (these are the betas in the exponents.)
ilogit(mod1$linear.predictors)
d<-data.frame('logit'=fitted(mod1),'probit'=fitted(modp),'loglog'=fitted(modc))
d%>%kbl%>%kable_classic_2()
x<-seq(-2,8,0.2)
p1<-ilogit(mod1$coefficients[1]+mod1$coefficients[2]*x)
pp<-pnorm(modp$coefficients[1]+modp$coefficients[2]*x)
pc<-1-exp(-exp((modc$coefficients[1]+modc$coefficients[2]*x)))
plot(x,p1,type='l', ylab = "Probability",xlab='Dose')
lines(x,pp,lty=2)
lines(x,pc,lty=5)
x <- seq(-2,8,0.2)
modl<-mod1
pl <- ilogit(modl$coef[1]+modl$coef[2]*x)
pp <- pnorm(modp$coef[1]+modp$coef[2]*x)
pc <- 1-exp(-exp((modc$coef[1]+modc$coef[2]*x)))
plot(x,pl,type="l",ylab="Probability",xlab="Dose")
lines(x,pp,lty=2)
lines(x,pc,lty=5)
matplot(x,cbind(pp/pl,(1-pp)/(1-
pl)),type="l",xlab="Dose",ylab="Ratio")
matplot(x,cbind(pc/pl,(1-pc)/(1-
pl)),type="l",xlab="Dose",ylab="Ratio")
data("hormone")
plot(estrogen~androgen, data=hormone, pch=as.character(orientation))
ggplot(hormone, aes(x=androgen,y=estrogen, color=orientation))+geom_point()
modl<-glm(orientation~estrogen+androgen, family = binomial(), data=hormone)
summary(modl)
ggplot(hormone, aes(x=androgen,y=estrogen, color=orientation))+geom_point()+geom_abline(intercept=-84.5/90.2,slope=100.9/90.2)
data(bliss)
modl<-glm(cbind(dead,alive)~conc, family=binomial(), data=bliss)
lmodsum<-summary(modl)
x0<-c(1,2.5)
#this is a dot product
eta0<-sum(x0*coef(modl))
#dot product verison
paste(x0%*%coef(modl),eta0)
#makes sense since it is a linear sum
ilogit(eta0)
#the covariance matrix
#how the variables vary together
cm<-lmodsum$cov.unscaled
#standard error on the logit scale is then
se<-sqrt(t(x0)%*%cm%*%x0)
#so the CI on the probability scale is then
ilogit(c(eta0-1.96*se,eta0+1.96*se))
(a<-predict(modl,newdata = data.frame(conc=2.5),se=TRUE))
ilogit(c(a$fit-1.96*a$se.fit,a$fit+1.96*a$se.fit))
x0 <- c(1,-5)
se <- sqrt(t(x0) %*% cm %*% x0)
eta0 <- sum(x0*modl$coef)
ilogit(c(eta0-1.96*se, eta0+1.96*se))
(ld50<- -modl$coefficients[1]/modl$coefficients[2])
dr <- c(-1/modl$coefficients[2],lmod$coefficients[1]/modl$coefficients[2]^2)
varg<-lmodsum$cov.unscaled
sqrt(dr%*%lmodsum$cov.un%*%dr)[,]
library(MASS)
dose.p(modl,p=c(.5,.9))
data(troutegg)
head(troutegg)
troutegg%>%arrange(location)%>%relocate(location,period,survive,total)
bmod<-glm(cbind(survive,total-survive)~location+period, family=binomial(),troutegg)
bmod
pchisq(64.5,12, lower=FALSE)
library(ggResidpanel)
resid_interact(bmod, plots='all')
halfnorm(residuals(bmod))
rbind(troutegg[15,],troutegg[20,])
elogits <-
log((troutegg$survive+0.5)/(troutegg$total-
troutegg$survive+0.5))
with(troutegg,interaction.plot(period,location,elogits)
)
df<-data.frame(elogits=elogits,period=troutegg$period,location=troutegg$location)
ggplot(df,aes(x=period,y=elogits,group=location,color=location))+geom_point()+geom_smooth(se=FALSE, method="loess", span=0.5)+ggtitle('interaction plot')
(sigma2<-sum(residuals(bmod,type='pearson')^2)/12)
drop1(bmod,scale=sigma2,test='F')
drop1(bmod,test='F')
summary(bmod, dispersion=sigma2)
summary(bmod)
view(babyfood)
